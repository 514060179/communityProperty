(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-complaintOrder-complaintOrder"],{"2f63":function(t,i,e){"use strict";e.r(i);var n=e("abd6"),s=e.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(a);i["default"]=s.a},5160:function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return s})),e.d(i,"a",(function(){}));var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",[e("v-uni-scroll-view",{staticClass:"bg-white nav",attrs:{"scroll-x":!0,"scroll-with-animation":!0,"scroll-left":t.scrollLeft}},[e("v-uni-view",{staticClass:"flex text-center"},[e("v-uni-view",{staticClass:"cu-item flex-sub",class:"10002"==t.state?"text-blue cur":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._tabSelect("10002")}}},[t._v("发起投诉")]),e("v-uni-view",{staticClass:"cu-item flex-sub",class:"10001"==t.state?"text-blue cur":"",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._tabSelect("10001")}}},[t._v("投诉历史")])],1)],1),"10001"==t.state?e("v-uni-view",{staticClass:"margin-top"},[e("v-uni-view",{staticClass:"cu-list menu-avatar"},t._l(t.myOrders,(function(i,n){return e("v-uni-view",{key:n,staticClass:"cu-item arrow",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t._toComplaintOrderDetail(i)}}},[e("v-uni-view",{staticClass:"cu-avatar round lg",style:"background-image:url("+t.orderImg+");"}),e("v-uni-view",{staticClass:"content"},[e("v-uni-view",{staticClass:"text-grey"},[t._v(t._s(i.complaintId))]),e("v-uni-view",{staticClass:"text-gray text-sm flex"},[e("v-uni-view",{staticClass:"text-cut"},[t._v(t._s(i.complaintName))])],1)],1),e("v-uni-view",{staticClass:"action"},[e("v-uni-view",{staticClass:"text-grey text-xs"},[t._v(t._s(i.createTime))])],1)],1)})),1)],1):t._e(),"10002"==t.state?e("v-uni-view",{staticClass:"margin-top"},[e("v-uni-view",{staticClass:"padding "},[e("v-uni-text",[t._v("房屋信息")])],1),e("v-uni-view",{staticClass:"cu-list menu "},[e("v-uni-view",{staticClass:"cu-item arrow",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._selectFloor()}}},[e("v-uni-view",{staticClass:"content"},[e("v-uni-text",{staticClass:"text-grey"},[t._v("楼栋")])],1),e("v-uni-view",{staticClass:"action"},[e("v-uni-text",{staticClass:"text-grey text-sm"},[t._v(t._s(""!=t.floorNum?t.floorNum+"号楼":"请选择"))])],1)],1),e("v-uni-view",{staticClass:"cu-item arrow",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._selectUnit()}}},[e("v-uni-view",{staticClass:"content"},[e("v-uni-text",{staticClass:"text-grey"},[t._v("单元")])],1),e("v-uni-view",{staticClass:"action"},[e("v-uni-text",{staticClass:"text-grey text-sm"},[t._v(t._s(""!=t.unitNum?t.unitNum+"单元":"请选择"))])],1)],1),e("v-uni-view",{staticClass:"cu-item arrow",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._selectRoom()}}},[e("v-uni-view",{staticClass:"content"},[e("v-uni-text",{staticClass:"text-grey"},[t._v("房屋")])],1),e("v-uni-view",{staticClass:"action"},[e("v-uni-text",{staticClass:"text-grey text-sm"},[t._v(t._s(""!=t.roomNum?t.roomNum+"室":"请选择"))])],1)],1)],1),e("v-uni-view",{staticClass:"padding margin-top"},[e("v-uni-text",[t._v("投诉信息")])],1),e("v-uni-form",[e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("投诉类型")]),e("v-uni-picker",{attrs:{value:t.typeCdIndex,range:t.typeCds},on:{change:function(i){arguments[0]=i=t.$handleEvent(i),t._changeResult.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"picker"},[t._v(t._s(t.typeCdIndex>-1?t.typeCds[t.typeCdIndex]:"请选择"))])],1)],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("投诉人")]),e("v-uni-input",{attrs:{placeholder:"请输入投诉人",name:"input"},model:{value:t.complaintName,callback:function(i){t.complaintName=i},expression:"complaintName"}})],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"title"},[t._v("手机号码")]),e("v-uni-input",{attrs:{placeholder:"输入手机号码",name:"input"},model:{value:t.tel,callback:function(i){t.tel=i},expression:"tel"}}),e("v-uni-view",{staticClass:"cu-capsule radius"},[e("v-uni-view",{staticClass:"cu-tag bg-blue "},[t._v("+86")]),e("v-uni-view",{staticClass:"cu-tag line-blue"},[t._v("中国大陆")])],1)],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-textarea",{attrs:{maxlength:"-1",placeholder:"请输入投诉内容"},model:{value:t.context,callback:function(i){t.context=i},expression:"context"}})],1),e("v-uni-view",{staticClass:"cu-bar bg-white margin-top"},[e("v-uni-view",{staticClass:"action"},[t._v("图片上传")]),e("v-uni-view",{staticClass:"action"},[t._v(t._s(t.imgList.length)+"/4")])],1),e("v-uni-view",{staticClass:"cu-form-group"},[e("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[t._l(t.imgList,(function(i,n){return e("v-uni-view",{key:n,staticClass:"bg-img",attrs:{"data-url":t.imgList[n]},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.ViewImage.apply(void 0,arguments)}}},[e("v-uni-image",{attrs:{src:t.imgList[n],mode:"aspectFill"}}),e("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":n},on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t._delImg.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)})),t.imgList.length<4?e("v-uni-view",{staticClass:"solids",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._chooseImage.apply(void 0,arguments)}}},[e("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):t._e()],2)],1)],1),e("v-uni-view",{staticClass:"padding flex flex-direction"},[e("v-uni-button",{staticClass:"cu-btn bg-blue margin-tb-sm lg",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._submitOrder()}}},[t._v("提交")])],1)],1):t._e()],1)},s=[]},6322:function(t,i,e){"use strict";e.r(i);var n=e("5160"),s=e("2f63");for(var a in s)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return s[t]}))}(a);var o=e("828b"),u=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"d5020202",null,!1,n["a"],void 0);i["default"]=u.exports},abd6:function(t,i,e){"use strict";e("6a54");var n=e("f5bd").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("bf0f"),e("2797"),e("5c47"),e("a1c1"),e("aa9c"),e("c223"),e("dd2b");var s=n(e("0c9b")),a=e("2d9e"),o=n(e("f0de")),u={data:function(){return{state:"10002",orderImg:s.default.baseUrl+"img/order.png",myOrders:[],imgList:[],photos:[],floorId:"",floorNum:"",unitId:"",unitNum:"",roomId:"",roomNum:"",typeCd:"",typeCds:["投诉","建议"],typeCdIndex:-1,complaintName:"",tel:"",context:""}},onLoad:function(){this.java110Context.onLoad()},onShow:function(){var t=this.java110Context.getParam("floorInfo");t&&(this.floorId=t.floorId,this.floorNum=t.floorNum);var i=this.java110Context.getParam("unitInfo");i&&(this.unitId=i.unitId,this.unitNum=i.unitNum);var e=this.java110Context.getParam("roomInfo");e&&(this.roomId=e.roomId,this.roomNum=e.roomNum)},methods:{_tabSelect:function(t){this.state=t,console.log("_tabSelect_this.state",this.state),"10002"==t||this._loadMyOrders()},_loadMyOrders:function(){var t=this,i=this.java110Context.getUserInfo(),e=i.storeId,n={page:1,row:15,storeId:e,userId:i.userId,process:"START",communityId:(0,a.getCurrentCommunity)().communityId};this.java110Context.request({url:o.default.listAuditHistoryComplaints,header:t.java110Context.getHeaders(),method:"GET",data:n,success:function(i){if(console.log("请求返回信息：",i),200==i.statusCode){var e=i.data;t.myOrders=e.complaints,e.complaints.forEach((function(t){var i=t.createTime.replace(/-/g,"/");console.log("_data.complaints_dateStr",i);var e=new Date(i);t.createTime=e.getMonth()+1+"-"+e.getDate()}))}else uni.showToast({icon:"none",title:i.data})},fail:function(t){wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}},0==this.myOrders.length)},_toComplaintOrderDetail:function(t){console.log("_item",t),uni.setStorageSync("_complaintOrderDetail_"+t.complaintId,t),uni.navigateTo({url:"/pages/complaintOrderDetail/complaintOrderDetail?complaintId="+t.complaintId})},_submitOrder:function(){var t=this,i=this.java110Context.getUserInfo(),e=i.storeId;0==this.typeCdIndex?this.typeCd="809001":this.typeCd="809002";var n={typeCd:this.typeCd,complaintName:this.complaintName,tel:this.tel,roomId:this.roomId,photos:[],context:this.context,userId:i.userId,storeId:e,communityId:(0,a.getCurrentCommunity)().communityId},s=this.photos;s.forEach((function(t){n.photos.push({photo:t})}));var u="";""==n.typeCd?u="请选择投诉类型":""==n.complaintName?u="请填写投诉人":""==n.tel?u="请填写手机号":""==n.context?u="请填写投诉内容":""==n.roomId&&(u="请选择房屋信息"),""!=u?uni.showToast({title:u,icon:"none",duration:2e3}):this.java110Context.request({url:o.default.saveComplaint,header:t.java110Context.getHeaders(),method:"POST",data:n,success:function(i){console.log(i),200==i.statusCode?(t.state="10001",t._loadMyOrders()):uni.showToast({icon:"none",title:i.data})},fail:function(t){console.log(t),wx.showToast({title:"服务器异常了",icon:"none",duration:2e3})}},!0)},_chooseImage:function(){var t=this,i=this;uni.chooseImage({count:4,sizeType:["original","compressed"],sourceType:["album"],success:function(e){0!=t.imgList.length?(t.imgList=t.imgList.concat(e.tempFilePaths),i.java110Factory.base64.urlTobase64(e.tempFilePaths).then((function(t){i.photos.push(t)}))):(t.imgList=e.tempFilePaths,i.photos=[])}})},_delImg:function(t){this.imgList.splice(t.currentTarget.dataset.index,1),this.photos.splice(t.currentTarget.dataset.index,1)},_selectFloor:function(){uni.navigateTo({url:"/pages/floorList/floorList?communityId="+(0,a.getCurrentCommunity)().communityId})},_selectUnit:function(){""!=this.floorId?uni.navigateTo({url:"/pages/unitList/unitList?communityId="+(0,a.getCurrentCommunity)().communityId+"&floorId="+this.floorId+"&floorNum="+this.floorNum}):uni.showToast({icon:"none",title:"请先选择楼栋"})},_selectRoom:function(){""!=this.floorId?""!=this.unitId?uni.navigateTo({url:"/pages/roomList/roomList?communityId="+(0,a.getCurrentCommunity)().communityId+"&floorId="+this.floorId+"&floorNum="+this.floorNum+"&unitId="+this.unitId+"&unitNum="+this.unitNum}):uni.showToast({icon:"none",title:"请先选择单元"}):uni.showToast({icon:"none",title:"请先选择楼栋"})},_changeResult:function(t){this.typeCdIndex=t.detail.value,console.log(t,this.typeCdIndex)}}};i.default=u}}]);