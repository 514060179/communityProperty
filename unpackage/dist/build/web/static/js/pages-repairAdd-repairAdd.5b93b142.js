(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repairAdd-repairAdd"],{1622:function(e,t,i){"use strict";i("6a54");var a=i("3639").default,n=i("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("bf0f"),i("2797"),i("aa9c");var o=n(i("39d8")),r=(a(i("d97e")),i("9ef9")),s=n(i("9b8e")),u=n(i("4361")),c=i("2d9e"),l=n(i("f0de")),p=n(i("840b"));s.default.prototype.$preventClick=r.preventClick;var d={data:function(){var e,t=this,i=function(e){return t.$t(e)};return e={onoff:!0,minDate:(new Date).getTime(),bindDate:i("please_select"),bindTime:i("please_select"),roomCloums:[],roomIdArr:[],roomName:"",roomId:"",roomShow:!1,typeName:"",repairType:"",typeShow:!1,timeShow:!1,imgList:[],bindTel:"",context:"",bindRepairName:"",photos:[],communityId:"",communityName:"",complaintIndex:0,index:0,repairScopes:[{id:"001",name:i("community")},{id:"002",name:i("building")},{id:"003",name:i("unit")},{id:"004",name:i("house")}],repairTypes:[],repairTypeIndex:0,repairScopeIndex:0,repairObjType:"001",repairObjId:"",repairObjName:"",floorNum:"",floorId:"",unitNum:"",unitId:"",roomNum:""},(0,o.default)(e,"roomId",""),(0,o.default)(e,"priceScope",""),(0,o.default)(e,"uploadImage",{maxPhotoNum:4,imgTitle:i("image_upload"),canEdit:!0}),(0,o.default)(e,"areaCodes",["+86","+852","+853"]),(0,o.default)(e,"areaCode","+86"),e},components:{uploadImageAsync:p.default},onLoad:function(e){this.java110Context.onLoad();this.java110Context.getUserInfo();this.communityId=(0,c.getCurrentCommunity)().communityId,this.communityName=(0,c.getCurrentCommunity)().name,this._loadRepairTypes()},onReady:function(){},onShow:function(){var e=uni.getStorageSync("_selectFloor");this.util.isNotNull(e)&&(this.floorNum=e.floorNum+this.$t("building_block"),this.floorId=e.floorId);var t=uni.getStorageSync("_selectUnit");this.util.isNotNull(t)&&(this.unitNum=t.unitNum+this.$t("unit"),this.unitId=t.unitId);var i=uni.getStorageSync("_selectRoom");this.util.isNotNull(i)&&(this.roomNum=i.roomNum+this.$t("room"),this.roomId=i.roomId)},onHide:function(){},onUnload:function(){uni.removeStorageSync("_selectFloor"),uni.removeStorageSync("_selectUnit"),uni.removeStorageSync("_selectRoom")},onPullDownRefresh:function(){},onReachBottom:function(){},onShareAppMessage:function(){},methods:{onPickerChange:function(e){this.areaCode=this.areaCodes[e.detail.value]},sendImagesData:function(e){var t=this;this.photos=[],e.length>0&&e.forEach((function(e){t.photos.push(e.fileId)}))},formatter:function(e,t){return"year"===e?"".concat(t,"年"):"month"===e?"".concat(t,"月"):"day"===e?"".concat(t,"日"):t},_loadRepairTypes:function(){var e=this,t="004"==e.repairObjType?"F":"T";e.repairTypeIndex=0;var i={page:1,row:50,communityId:e.communityId,publicArea:t};this.java110Context.request({url:l.default.listRepairSettings,header:e.java110Context.getHeaders(),method:"GET",data:i,success:function(t){var i=t.data;if(0==i.code){e.repairTypes=i.data;var a=e.repairTypes[e.repairTypeIndex];e.repairType=a.repairType;var n=a.payFeeFlag;e.priceScope="T"==n?a.priceScope:""}},fail:function(t){wx.showToast({title:e.$t("server_error"),icon:"none",duration:2e3})}},0==this.repairTypes.length)},submitRepair:function(e){var t=this,i={repairName:this.bindRepairName,repairType:this.repairType,appointmentTime:this.bindDate+" "+this.bindTime+":00",tel:this.bindTel,roomId:this.roomId,photos:this.photos,context:this.context,communityId:this.communityId,bindDate:this.bindDate,bindTime:this.bindTime,repairObjType:this.repairObjType,repairChannel:"D",areaCode:this.areaCode};"001"==this.repairObjType?(i.repairObjId=this.communityId,i.repairObjName=this.communityName):"002"==this.repairObjType?(i.repairObjId=this.floorId,i.repairObjName=this.floorNum):"003"==this.repairObjType?(i.repairObjId=this.unitId,i.repairObjName=this.floorNum+this.unitNum):(i.repairObjId=this.roomId,i.repairObjName=this.floorNum+this.unitNum+this.roomNum);var a="";""==i.repairType?a=t.$t("select_repair_type"):""==i.repairName?a=t.$t("fill_in_reporter"):""==i.tel?a=t.$t("fill_in_phone_number"):u.default.checkPhoneNumber(i.tel,t.areaCode)?i.bindDate==t.$t("please_select")?a=t.$t("select_appointment_date"):i.bindTime==t.$t("please_select")?a=t.$t("select_appointment_time"):""==i.context?a=t.$t("fill_in_repair_content"):""==i.repairObjId&&(a=t.$t("select_repair_location")):a=t.$t("please_input_phone"),""!=a?(t.onoff=!0,uni.hideLoading(),uni.showToast({title:a,icon:"none",duration:2e3})):t.java110Context.request({url:l.default.saveHelpOwnerRepair,header:t.java110Context.getHeaders(),method:"POST",data:i,success:function(e){t.onoff=!0;var i=e.data;0!=i.code?(uni.hideLoading(),uni.showToast({title:i.msg,icon:"none",duration:2e3})):uni.redirectTo({url:"/pages/repairOrder/repairOrder"})},fail:function(e){t.onoff=!0,uni.hideLoading(),uni.showToast({title:t.$t("server_error"),icon:"none",duration:2e3})}},!0)},chooseFloor:function(e){uni.removeStorageSync("_selectFloor"),this.floorNum="",this.floorId="",uni.removeStorageSync("_selectUnit"),this.unitNum="",this.unitId="",uni.removeStorageSync("_selectRoom"),this.roomNum="",this.roomId="",uni.navigateTo({url:"/pages/selectFloor/selectFloor"})},chooseUnit:function(e){null!=this.floorId&&""!=this.floorId?(uni.removeStorageSync("_selectUnit"),this.unitNum="",this.unitId="",uni.removeStorageSync("_selectRoom"),this.roomNum="",this.roomId="",uni.navigateTo({url:"/pages/selectUnit/selectUnit?floorId="+this.floorId})):uni.showToast({title:this.$t("select_building_first")})},chooseRoom:function(e){null!=this.unitId&&""!=this.unitId?(uni.removeStorageSync("_selectRoom"),this.roomNum="",this.roomId="",uni.navigateTo({url:"/pages/selectRoom/selectRoom?floorId="+this.floorId+"&unitId="+this.unitId})):uni.showToast({title:this.$t("select_unit_first")})},repairScopeChange:function(e){this.repairScopeIndex=e.target.value;var t=this.repairScopes[this.repairScopeIndex];this.repairObjType=t.id,this._loadRepairTypes()},repairTypeChange:function(e){this.repairTypeIndex=e.target.value;var t=this.repairTypes[this.repairTypeIndex];if(void 0!=t){this.repairType=t.repairType;var i=t.payFeeFlag;this.priceScope="T"==i?t.priceScope:""}},dateChange:function(e){this.bindDate=e.detail.value},timeChange:function(e){this.bindTime=e.detail.value}}};t.default=d},"38d3":function(e,t,i){"use strict";var a=i("c0a2"),n=i.n(a);n.a},"4b13":function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("v-uni-view",{staticClass:"block__title"},[e._v(e._s(e.$t("house_information")))]),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("location")))]),i("v-uni-picker",{attrs:{bindchange:"PickerChange",value:e.repairScopeIndex,range:e.repairScopes,"range-key":"name"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.repairScopeChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.repairScopes[e.repairScopeIndex].name))])],1)],1),"002"==e.repairObjType||"003"==e.repairObjType||"004"==e.repairObjType?i("v-uni-view",{staticClass:"cu-form-group arrow",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseFloor.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("building")))]),i("v-uni-input",{staticClass:"text-right",attrs:{required:!0,readonly:!0,label:"楼栋",placeholder:e.$t("select_building"),name:"floorNum",icon:"arrow"},model:{value:e.floorNum,callback:function(t){e.floorNum=t},expression:"floorNum"}}),i("v-uni-text",{staticClass:"cuIcon-right"})],1):e._e(),"003"==e.repairObjType||"004"==e.repairObjType?i("v-uni-view",{staticClass:"cu-form-group arrow",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseUnit.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("unit")))]),i("v-uni-input",{staticClass:"text-right",attrs:{placeholder:e.$t("select_unit")},model:{value:e.unitNum,callback:function(t){e.unitNum=t},expression:"unitNum"}}),i("v-uni-text",{staticClass:"cuIcon-right"})],1):e._e(),"004"==e.repairObjType?i("v-uni-view",{staticClass:"cu-form-group",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseRoom.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("house_information")))]),i("v-uni-input",{staticClass:"text-right",attrs:{placeholder:e.$t("select_house")},model:{value:e.roomNum,callback:function(t){e.roomNum=t},expression:"roomNum"}}),i("v-uni-text",{staticClass:"cuIcon-right"})],1):e._e(),i("v-uni-view",{staticClass:"block__title"},[e._v(e._s(e.$t("repair_information")))]),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("repair_type")))]),i("v-uni-picker",{attrs:{id:"complaintType",bindchange:"PickerChange",value:e.repairTypeIndex,"range-key":"repairTypeName",range:e.repairTypes},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.repairTypeChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[e._v(e._s(0==e.repairTypes.length?e.$t("please_select"):e.repairTypes[e.repairTypeIndex].repairTypeName))])],1)],1),""!=e.priceScope?i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("charge_standard")))]),i("v-uni-input",{staticClass:"text-right",attrs:{disabled:"disable"},model:{value:e.priceScope,callback:function(t){e.priceScope=t},expression:"priceScope"}})],1):e._e(),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("reporter")))]),i("v-uni-input",{staticClass:"text-right",attrs:{placeholder:e.$t("enter_reporter")},model:{value:e.bindRepairName,callback:function(t){e.bindRepairName=t},expression:"bindRepairName"}})],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("phone_number")))]),i("v-uni-view",{staticClass:"phone-input"},[i("v-uni-input",{staticClass:"text-right",attrs:{placeholder:e.$t("enter_phone_number")},model:{value:e.bindTel,callback:function(t){e.bindTel=t},expression:"bindTel"}}),i("v-uni-picker",{attrs:{mode:"selector",range:e.areaCodes},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.onPickerChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.areaCode))])],1)],1)],1),i("v-uni-view",{staticClass:"cu-form-group arrow"},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("appointment_date")))]),i("v-uni-picker",{attrs:{mode:"date",value:e.bindDate,start:"2020-09-01",end:"2050-09-01"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.dateChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.bindDate))])],1)],1),i("v-uni-view",{staticClass:"cu-form-group arrow"},[i("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("appointment_time")))]),i("v-uni-picker",{attrs:{mode:"time",value:e.bindTime,start:"08:30",end:"22:00"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.timeChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.bindTime))])],1)],1),i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-textarea",{attrs:{placeholder:e.$t("enter_repair_content")},model:{value:e.context,callback:function(t){e.context=t},expression:"context"}})],1),i("v-uni-view",{staticClass:"block__title"},[e._v(e._s(e.$t("related_images")))]),i("uploadImageAsync",{ref:"vcUploadRef",attrs:{communityId:e.communityId,maxPhotoNum:e.uploadImage.maxPhotoNum,canEdit:e.uploadImage.canEdit,title:e.uploadImage.imgTitle},on:{sendImagesData:function(t){arguments[0]=t=e.$handleEvent(t),e.sendImagesData.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"button_up_blank"}),i("v-uni-view",{staticClass:"flex flex-direction"},[i("v-uni-button",{staticClass:"cu-btn bg-blue margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$preventClick(e.submitRepair)}}},[e._v("提交")])],1)],1)},n=[]},"65f8":function(e,t,i){var a=i("c86c");t=a(!1),t.push([e.i,".block__title[data-v-363d5d92]{margin:0;font-weight:400;font-size:14px;color:rgba(69,90,100,.6);padding:%?40?% %?30?% %?20?%}.button_up_blank[data-v-363d5d92]{height:%?40?%}[data-v-363d5d92] .phone-input{display:flex;align-items:center}[data-v-363d5d92] .phone-input uni-picker{flex:none!important}",""]),e.exports=t},8566:function(e,t,i){"use strict";i.r(t);var a=i("4b13"),n=i("b32a");for(var o in n)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("38d3");var r=i("828b"),s=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"363d5d92",null,!1,a["a"],void 0);t["default"]=s.exports},"9ef9":function(e,t,i){"use strict";i("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.getFileType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("."),i=t[t.length-1];if(!i)return"";i=i.toLocaleLowerCase();var a=["png","jpg","jpeg","bmp","gif","webp"];if(a.includes(i))return"image";var n=["mp4","m4v"];if(n.includes(i))return"video";var o=["mp3","m4a","wav","aac"];if(o.includes(i))return"audio";var r=["pdf","doc","docx","xls","xlsx","ppt","pptx","txt","plain"];return r.includes(i)?"office":"unknown"},t.preventClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=this;i.onoff?(i.onoff=!1,e(t)):uni.showToast({title:"操作过于频繁",icon:"none"})},i("4626")},b32a:function(e,t,i){"use strict";i.r(t);var a=i("1622"),n=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},c0a2:function(e,t,i){var a=i("65f8");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("967d").default;n("d7b996a8",a,!0,{sourceMap:!1,shadowMode:!1})}}]);