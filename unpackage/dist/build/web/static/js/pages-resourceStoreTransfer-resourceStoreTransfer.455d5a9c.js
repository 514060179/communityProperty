(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-resourceStoreTransfer-resourceStoreTransfer"],{"080e":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.showModel?i("v-uni-view",{staticClass:"select-single-resource"},[i("v-uni-view",[i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[e._v("员工")]),i("v-uni-picker",{attrs:{value:e.staffIndex,range:e.staffCloums,"range-key":"name"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.staffChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.staffCloums[e.staffIndex].name))])],1)],1),i("v-uni-view",{staticClass:"flex flex-direction margin-top"},[i("v-uni-button",{staticClass:"cu-btn bg-blue margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._save()}}},[e._v("确定")])],1),i("v-uni-view",{staticClass:"flex flex-direction margin-top"},[i("v-uni-button",{staticClass:"cu-btn bg-red margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._canel()}}},[e._v("取消")])],1)],1)],1):e._e()},s=[]},1070:function(e,t,i){"use strict";i.r(t);var n=i("79f4"),s=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=s.a},"3bdf":function(e,t,i){var n=i("c86c");t=n(!1),t.push([e.i,".select-single-resource[data-v-92c125c4]{position:fixed;top:%?100?%;left:0;background-color:#fff;width:100%;height:100%}.use-num-container[data-v-92c125c4]{display:flex;flex-direction:row}.use-num-input[data-v-92c125c4]{width:%?100?%;text-align:center;padding:0}.inc[data-v-92c125c4],.dec[data-v-92c125c4]{border:1px solid #000;border-radius:50%;width:%?40?%;height:%?40?%;text-align:center;line-height:%?40?%}",""]),e.exports=t},"44ab":function(e,t,i){"use strict";i.r(t);var n=i("080e"),s=i("1070");for(var a in s)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return s[e]}))}(a);i("feda");var o=i("828b"),c=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"92c125c4",null,!1,n["a"],void 0);t["default"]=c.exports},"52ff":function(e,t,i){var n=i("3bdf");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var s=i("967d").default;s("77064c66",n,!0,{sourceMap:!1,shadowMode:!1})},"56ca":function(e,t,i){"use strict";var n=i("a3af"),s=i.n(n);s.a},"57a3":function(e,t,i){var n=i("c86c");t=n(!1),t.push([e.i,".footer-step-fixed[data-v-2e501dc4]{width:100%;position:fixed;left:0;bottom:0;display:flex;justify-content:space-between;-moz-box-shadow:0 -5px 5px #ccc;box-shadow:0 -5px 5px #ccc;background-color:#fff}.step-item[data-v-2e501dc4]{width:100%;text-align:center;height:%?80?%;line-height:%?80?%}.cu-list.menu-avatar>.cu-item .content-left[data-v-2e501dc4]{left:0}.cu-list+.cu-list[data-v-2e501dc4]{margin-top:%?20?%}.flex-item[data-v-2e501dc4]{display:flex;flex-direction:row}.w50[data-v-2e501dc4]{width:50%}.flex uni-label[data-v-2e501dc4], .flex-item uni-label[data-v-2e501dc4]{width:%?250?%}.use-number[data-v-2e501dc4]{width:%?200?%;border-radius:%?15?%}.remark[data-v-2e501dc4]{width:80%;border-radius:%?15?%}.item-remove[data-v-2e501dc4]{border-radius:%?15?%;padding:%?2?% %?10?%}.flex-around[data-v-2e501dc4]{display:flex;justify-content:space-between;padding:0 %?20?%}",""]),e.exports=t},"79f4":function(e,t,i){"use strict";i("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("c223");var n=i("e476"),s=i("2d9e"),a={components:{},data:function(){return{showModel:!1,communityId:"",orgIndex:0,selectedOrg:"",staffCloums:[{name:"请选择员工"}],staffIndex:0,selectedStaff:""}},props:{},watch:{},created:function(){},computed:{},mounted:function(){this.communityId=(0,s.getCurrentCommunity)().communityId,this._loadStaffList()},methods:{switchShow:function(){this.showModel=!this.showModel},_loadStaffList:function(){var e=this,t={page:1,row:50,communityId:this.communityId};(0,n.queryStaffListInfo)(this,t,0==this.staffCloums.length).then((function(t){e.staffCloums=e.staffCloums.concat(t.data.staffs)}))},orgChange:function(e){if(this.orgIndex=e.target.value,this.depCloums=[{orgName:"请选择部门"}],this.depIndex=0,this.selectedDep="",this.staffCloums=[{name:"请选择员工"}],this.staffIndex=0,this.selectedStaff="",0!=this.orgIndex){var t=this.orgCloums[this.orgIndex];this.selectedOrg=t,this._loadDepList()}},depChange:function(e){if(this.depIndex=e.target.value,this.staffCloums=[{name:"请选择员工"}],this.staffIndex=0,this.selectedStaff="",0!=this.depIndex){var t=this.depCloums[this.depIndex];this.selectedDep=t,this._loadStaffList()}},staffChange:function(e){if(this.staffIndex=e.target.value,this.selectedStaff="",0!=this.staffIndex){var t=this.staffCloums[this.staffIndex];this.selectedStaff=t}},_save:function(){""!=this.selectedStaff?(this.$emit("getStaffInfo",this.selectedStaff),this.showModel=!1):uni.showToast({title:"请选择员工",icon:"none"})},_canel:function(){this.showModel=!1}}};t.default=a},a3af:function(e,t,i){var n=i("57a3");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var s=i("967d").default;s("2af60f00",n,!0,{sourceMap:!1,shadowMode:!1})},aa08:function(e,t,i){"use strict";i.r(t);var n=i("ea46"),s=i("ef22");for(var a in s)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return s[e]}))}(a);i("56ca");var o=i("828b"),c=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"2e501dc4",null,!1,n["a"],void 0);t["default"]=c.exports},d28f:function(e,t,i){"use strict";i("6a54");var n=i("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("bf0f"),i("2797"),i("01a2"),i("e39c"),i("e966"),i("dd2b");var s=i("6efb"),a=i("9ef9"),o=n(i("9b8e")),c=n(i("e4e5")),r=n(i("44ab")),u=i("2d9e");o.default.prototype.$preventClick=a.preventClick;var f={data:function(){return{onoff:!0,description:"",resourceStores:[],apply_type:2e4,acceptUserId:"",acceptUserName:""}},components:{selectResourceStaff:c.default,selectStaff:r.default},onLoad:function(){this.java110Context.onLoad()},methods:{_openChooseResourceModel:function(){this.$refs.selectresourcestaff.switchShow()},_openChooseStaffModel:function(){this.$refs.selectstaff.switchShow()},_getStaffInfo:function(e){this.acceptUserId=e.userId,this.acceptUserName=e.userName},_getResourceInfo:function(e){this.resourceStores=e,this.resourceStores.forEach((function(e){e.giveQuantity=0}))},save:function(){var e=this;if(this.resourceStores.length<1)return e.onoff=!0,void this._showToast("请选择物品");var t="";if(""==this.description&&(t="请输入转赠说明"),""==this.acceptUserId)t="请选择员工";else{var i=this.java110Context.getUserInfo().userId;i==this.acceptUserId&&(t="不能转赠给自己")}if(this.resourceStores.forEach((function(e){!e.hasOwnProperty("giveQuantity")||parseInt(e.giveQuantity)<1?t="请填写数量":(e.giveQuantity=parseInt(e.giveQuantity),e.giveQuantity>parseInt(e.miniStock)&&(t=e.resName+",库存不足"))})),""!=t)return e.onoff=!0,void this._showToast(t);var n={resourceStores:this.resourceStores,description:this.description,acceptUserId:this.acceptUserId,acceptUserName:this.acceptUserName,communityId:(0,u.getCurrentCommunity)().communityId};(0,s.saveResourceStoreTransfer)(this,n,!0).then((function(t){if(0==t.code)return e.onoff=!0,void uni.navigateBack({delta:1});e.onoff=!0}))},_removeItem:function(e,t){this.resourceStores.splice(e,1),this.$refs.selectresourcestaff.removeSelectedItem(t)},_storeHousesChange:function(e,t){this.$set(this.selectedStoreHousesList,e,t.target.value),this.resourceStores[e].shzId=this.storeHouses[this.selectedStoreHousesList[e]].shId},_showToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";uni.showToast({title:e,icon:t})}}};t.default=f},e476:function(e,t,i){"use strict";i("6a54");var n=i("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.queryOrgInfo=function(e,t,i){return new Promise((function(n,a){e.context.get({url:s.default.queryOrgInfo,data:t,success:function(e){n(e)},fail:function(e){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}},i)}))},t.queryStaffListInfo=function(e,t,i){return new Promise((function(n,a){e.context.get({url:s.default.queryStaffListInfo,data:t,success:function(e){n(e)},fail:function(e){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}},i)}))},t.uploadImageAsync=function(e,t,i){return new Promise((function(n,a){t.context.post({url:s.default.uploadImage,data:e,success:function(e){if(200==e.statusCode){var t=e.data;n(t)}},fail:function(e){uni.hideLoading(),uni.showToast({title:i18n.t("server_error"),icon:"none"})}},i)}))},i("bf0f");var s=n(i("f0de"))},ea46:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={selectResourceStaff:i("e4e5").default,selectStaff:i("44ab").default},s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("v-uni-view",{staticStyle:{"padding-bottom":"100rpx"}},[i("v-uni-view",{staticClass:"cu-bar bg-white search "},[i("v-uni-view",{staticClass:"action"},[i("v-uni-button",{staticClass:"cu-btn bg-gradual-blue shadow-blur round",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._openChooseResourceModel()}}},[e._v("选择物品")])],1)],1),i("v-uni-view",{staticClass:"margin-top"},e._l(e.resourceStores,(function(t,n){return i("v-uni-view",{key:n,staticClass:"cu-list menu-avatar "},[i("v-uni-view",{staticClass:"cu-item",staticStyle:{height:"180rpx"}},[i("v-uni-view",{staticClass:"content content-left",staticStyle:{width:"100%"}},[i("v-uni-view",{staticClass:"text-grey flex-around"},[i("v-uni-text",{staticClass:"ellip"},[e._v(e._s(t.resName)+"("+e._s(t.parentRstName)+">"+e._s(t.rstName)+")")]),i("v-uni-text",{staticClass:"item-remove bg-red text-df",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e._removeItem(n,t.resId)}}},[e._v("移除")])],1),i("v-uni-view",{staticClass:"text-gray flex-around text-df",staticStyle:{margin:"10rpx 0"}},[i("v-uni-text",[e._v("当前库存:")]),i("v-uni-text",[e._v(e._s(t.miniStock)+e._s(t.miniUnitCodeName))])],1),i("v-uni-view",{staticClass:"text-gray flex-around"},[i("v-uni-label",[e._v("数量("+e._s(t.miniUnitCodeName)+"):")]),i("v-uni-input",{staticClass:"use-number bg-gray",attrs:{type:"number",value:""},model:{value:t.giveQuantity,callback:function(i){e.$set(t,"giveQuantity",i)},expression:"item.giveQuantity"}})],1)],1)],1)],1)})),1),i("v-uni-view",{staticClass:"cu-bar bg-white search margin-top"},[i("v-uni-view",{staticClass:"action"},[i("v-uni-button",{staticClass:"cu-btn bg-gradual-blue shadow-blur round",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._openChooseStaffModel()}}},[e._v("选择员工")])],1)],1),e.acceptUserId?i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[e._v("员工")]),i("v-uni-input",{attrs:{disabled:"disabled"},model:{value:e.acceptUserName,callback:function(t){e.acceptUserName=t},expression:"acceptUserName"}})],1):e._e(),i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[e._v("转赠说明")]),i("v-uni-input",{attrs:{placeholder:"请输入转赠说明"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1)],1),i("v-uni-view",{staticClass:"footer-step-fixed"},[i("v-uni-view",{staticClass:"step-item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$preventClick(e.save)}}},[e._v("提交")])],1),i("select-resource-staff",{ref:"selectresourcestaff",on:{getResourceInfo:function(t){arguments[0]=t=e.$handleEvent(t),e._getResourceInfo.apply(void 0,arguments)}}}),i("select-staff",{ref:"selectstaff",on:{getStaffInfo:function(t){arguments[0]=t=e.$handleEvent(t),e._getStaffInfo.apply(void 0,arguments)}}})],1)},a=[]},ef22:function(e,t,i){"use strict";i.r(t);var n=i("d28f"),s=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=s.a},feda:function(e,t,i){"use strict";var n=i("52ff"),s=i.n(n);s.a}}]);