(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-resourceStoreScrap-resourceStoreScrap"],{"095f":function(e,t,s){var a=s("fe21");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=s("967d").default;i("353cab96",a,!0,{sourceMap:!1,shadowMode:!1})},"9ba6":function(e,t,s){"use strict";s("6a54");var a=s("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,s("bf0f"),s("2797"),s("e966"),s("d4b5"),s("aa9c"),s("dd2b");var i=s("6efb"),n=s("9ef9"),r=a(s("9b8e")),c=a(s("e4e5")),o=s("2d9e");r.default.prototype.$preventClick=n.preventClick;var u={data:function(){return{onoff:!0,resourceStores:[],scrapTypes:[{state:"",stateName:"请选择"},{state:"1001",stateName:"报废回收"},{state:"3003",stateName:"公用损耗"}],flag:1,selectedScrapTypesList:[]}},components:{selectResourceStaff:c.default},onLoad:function(){this.java110Context.onLoad()},methods:{_openChooseResourceModel:function(){this.$refs.selectresourcestaff.switchShow()},save:function(){if(this.resourceStores.length<1)return this.onoff=!0,void this._showToast("请选择物品");var e="";if(this.resourceStores.forEach((function(t){!t.hasOwnProperty("giveQuantity")||!t.giveQuantity||parseInt(t.giveQuantity)<1?e="请填写数量":(t.giveQuantity=parseInt(t.giveQuantity),t.giveQuantity>parseInt(t.miniStock)?e=t.resName+",库存不足":t.hasOwnProperty("state")&&t.state?t.hasOwnProperty("purchaseRemark")&&t.purchaseRemark||(e="请填写备注"):e="请选择损耗类型")})),""!=e)return this.onoff=!0,void this._showToast(e);var t={resourceStores:this.resourceStores,flag:this.flag,communityId:(0,o.getCurrentCommunity)().communityId};(0,i.saveResourceStoreTransfer)(this,t,!0).then((function(e){0!=e.code||uni.navigateBack({delta:1})}))},_getResourceInfo:function(e){var t=this,s=JSON.stringify(e),a=JSON.parse(s);a.forEach((function(e){var s=!0;t.resourceStores.forEach((function(t){e.resId==t.resId&&(s=!1)})),s&&(e.giveQuantity=0,e.purchaseRemark="",t.resourceStores.push(e),t.selectedScrapTypesList.push(0))}))},_removeItem:function(e,t){this.resourceStores.splice(e,1),this.selectedScrapTypesList.splice(e,1),this.$refs.selectresourcestaff.removeSelectedItem(t),console.log(this.resourceStores)},_itemReturnAll:function(e,t){this.resourceStores.forEach((function(e){e.resId==t&&(e.giveQuantity=e.miniStock)})),this.$forceUpdate()},_decItemCurstock:function(e){this.resourceStores.forEach((function(t){t.resId==e&&t.giveQuantity>1&&(t.giveQuantity-=1)})),this.$forceUpdate()},_incItemCurstock:function(e){this.resourceStores.forEach((function(t){t.resId==e&&t.miniStock>t.giveQuantity&&(t.giveQuantity+=1)})),this.$forceUpdate()},_scrapTypesChange:function(e,t){this.$set(this.selectedScrapTypesList,e,t.target.value),console.log(this.scrapTypes[this.selectedScrapTypesList[e]].state),this.resourceStores[e].state=this.scrapTypes[this.selectedScrapTypesList[e]].state},_showToast:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";uni.showToast({title:e,icon:t})}}};t.default=u},a64b:function(e,t,s){"use strict";var a=s("095f"),i=s.n(a);i.a},a839:function(e,t,s){"use strict";s.r(t);var a=s("9ba6"),i=s.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){s.d(t,e,(function(){return a[e]}))}(n);t["default"]=i.a},d0c6:function(e,t,s){"use strict";s.r(t);var a=s("d785"),i=s("a839");for(var n in i)["default"].indexOf(n)<0&&function(e){s.d(t,e,(function(){return i[e]}))}(n);s("a64b");var r=s("828b"),c=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"bb7b43f4",null,!1,a["a"],void 0);t["default"]=c.exports},d785:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n})),s.d(t,"a",(function(){return a}));var a={selectResourceStaff:s("e4e5").default},i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-uni-view",[s("v-uni-view",{staticStyle:{"padding-bottom":"100rpx"}},[s("v-uni-view",{staticClass:"cu-bar bg-white search "},[s("v-uni-view",{staticClass:"action"},[s("v-uni-button",{staticClass:"cu-btn bg-gradual-blue shadow-blur round",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._openChooseResourceModel()}}},[e._v("选择物品")])],1)],1),s("v-uni-view",{staticClass:"margin-top"},e._l(e.resourceStores,(function(t,a){return s("v-uni-view",{key:a,staticClass:"cu-list menu-avatar "},[s("v-uni-view",{staticClass:"cu-item",staticStyle:{height:"320rpx"}},[s("v-uni-view",{staticClass:"content content-left",staticStyle:{width:"100%"}},[s("v-uni-view",{staticClass:"text-grey flex-around"},[s("v-uni-text",{staticClass:"ellip"},[e._v(e._s(t.resName)+"("+e._s(t.parentRstName)+">"+e._s(t.rstName)+")")]),s("v-uni-text",{staticClass:"item-remove bg-red text-df",on:{click:function(s){arguments[0]=s=e.$handleEvent(s),e._removeItem(a,t.resId)}}},[e._v("移除")])],1),s("v-uni-view",{staticClass:"text-gray flex-around text-df",staticStyle:{margin:"10rpx 0"}},[s("v-uni-view",[s("v-uni-text",[e._v("当前库存:")]),s("v-uni-text",[e._v(e._s(t.miniStock)+e._s(t.miniUnitCodeName))])],1)],1),s("v-uni-view",{staticClass:"text-gray flex-around",staticStyle:{margin:"10rpx 0"}},[s("v-uni-label",[e._v("损耗类型:")]),s("v-uni-picker",{attrs:{value:e.selectedScrapTypesList[a],range:e.scrapTypes,"range-key":"stateName"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e._scrapTypesChange(a,t)}}},[s("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.scrapTypes[e.selectedScrapTypesList[a]].stateName))])],1)],1),s("v-uni-view",{staticClass:"text-gray flex-around",staticStyle:{margin:"10rpx 0"}},[s("v-uni-label",[e._v("损耗数量("+e._s(t.miniUnitCodeName)+"):")]),s("v-uni-view",{staticClass:"flex"},[s("v-uni-text",{staticClass:"cuIcon-move",on:{click:function(s){arguments[0]=s=e.$handleEvent(s),e._decItemCurstock(t.resId)}}}),s("v-uni-input",{staticClass:"use-number bg-gray",attrs:{type:"number",value:""},model:{value:t.giveQuantity,callback:function(s){e.$set(t,"giveQuantity",s)},expression:"item.giveQuantity"}}),s("v-uni-text",{staticClass:"cuIcon-add",on:{click:function(s){arguments[0]=s=e.$handleEvent(s),e._incItemCurstock(t.resId)}}})],1)],1),s("v-uni-view",{staticClass:"text-gray flex-around",staticStyle:{margin:"10rpx 0"}},[s("v-uni-label",{staticClass:"text-df"},[e._v("备注:")]),s("v-uni-input",{staticClass:"remark bg-gray",attrs:{type:"text",value:""},model:{value:t.purchaseRemark,callback:function(s){e.$set(t,"purchaseRemark",s)},expression:"item.purchaseRemark"}})],1)],1)],1)],1)})),1)],1),s("v-uni-view",{staticClass:"footer-step-fixed"},[s("v-uni-view",{staticClass:"step-item",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$preventClick(e.save)}}},[e._v("提交")])],1),s("select-resource-staff",{ref:"selectresourcestaff",on:{getResourceInfo:function(t){arguments[0]=t=e.$handleEvent(t),e._getResourceInfo.apply(void 0,arguments)}}})],1)},n=[]},fe21:function(e,t,s){var a=s("c86c");t=a(!1),t.push([e.i,".footer-step-fixed[data-v-bb7b43f4]{width:100%;position:fixed;left:0;bottom:0;display:flex;justify-content:space-between;-moz-box-shadow:0 -5px 5px #ccc;box-shadow:0 -5px 5px #ccc;background-color:#fff}.step-item[data-v-bb7b43f4]{width:100%;text-align:center;height:%?80?%;line-height:%?80?%}.cu-list.menu-avatar>.cu-item .content-left[data-v-bb7b43f4]{left:0}.cu-list+.cu-list[data-v-bb7b43f4]{margin-top:%?20?%}.remark[data-v-bb7b43f4]{width:80%;border-radius:%?15?%}.flex uni-label[data-v-bb7b43f4], .flex-around uni-label[data-v-bb7b43f4]{width:%?250?%}.use-number[data-v-bb7b43f4]{width:%?200?%;border-radius:%?15?%}.item-remove[data-v-bb7b43f4]{border-radius:%?15?%;padding:%?2?% %?10?%}.flex-around[data-v-bb7b43f4]{display:flex;justify-content:space-between;padding:0 %?20?%}",""]),e.exports=t}}]);