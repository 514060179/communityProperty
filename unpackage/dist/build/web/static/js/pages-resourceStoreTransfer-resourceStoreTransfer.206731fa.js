(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-resourceStoreTransfer-resourceStoreTransfer"],{"103f":function(t,e,i){"use strict";i.r(e);var n=i("5ae2"),s=i("614d");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("7c1a");var o=i("828b"),r=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"4516fd68",null,!1,n["a"],void 0);e["default"]=r.exports},2277:function(t,e,i){var n=i("c86c");e=n(!1),e.push([t.i,".footer-step-fixed[data-v-11b00b64]{width:100%;position:fixed;left:0;bottom:0;display:flex;justify-content:space-between;-moz-box-shadow:0 -5px 5px #ccc;box-shadow:0 -5px 5px #ccc;background-color:#fff}.step-item[data-v-11b00b64]{width:100%;text-align:center;height:%?80?%;line-height:%?80?%}.cu-list.menu-avatar>.cu-item .content-left[data-v-11b00b64]{left:0}.cu-list+.cu-list[data-v-11b00b64]{margin-top:%?20?%}.flex-item[data-v-11b00b64]{display:flex;flex-direction:row}.w50[data-v-11b00b64]{width:50%}.flex uni-label[data-v-11b00b64], .flex-item uni-label[data-v-11b00b64]{width:%?250?%}.use-number[data-v-11b00b64]{width:%?200?%;border-radius:%?15?%}.remark[data-v-11b00b64]{width:80%;border-radius:%?15?%}.item-remove[data-v-11b00b64]{border-radius:%?15?%;padding:%?2?% %?10?%}.flex-around[data-v-11b00b64]{display:flex;justify-content:space-between;padding:0 %?20?%}",""]),t.exports=e},"3c26":function(t,e,i){"use strict";i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("bf0f"),i("2797"),i("01a2"),i("e39c"),i("e966"),i("dd2b");var s=i("91e9"),a=i("cc44"),o=n(i("9b8e")),r=n(i("117a")),c=n(i("103f")),u=i("dae2");o.default.prototype.$preventClick=a.preventClick;var f={data:function(){return{onoff:!0,description:"",resourceStores:[],apply_type:2e4,acceptUserId:"",acceptUserName:""}},components:{selectResourceStaff:r.default,selectStaff:c.default},onLoad:function(){this.java110Context.onLoad()},methods:{_openChooseResourceModel:function(){this.$refs.selectresourcestaff.switchShow()},_openChooseStaffModel:function(){this.$refs.selectstaff.switchShow()},_getStaffInfo:function(t){this.acceptUserId=t.userId,this.acceptUserName=t.userName},_getResourceInfo:function(t){this.resourceStores=t,this.resourceStores.forEach((function(t){t.giveQuantity=0}))},save:function(){var t=this;if(this.resourceStores.length<1)return t.onoff=!0,void this._showToast("请选择物品");var e="";if(""==this.description&&(e="请输入转赠说明"),""==this.acceptUserId)e="请选择员工";else{var i=this.java110Context.getUserInfo().userId;i==this.acceptUserId&&(e="不能转赠给自己")}if(this.resourceStores.forEach((function(t){!t.hasOwnProperty("giveQuantity")||parseInt(t.giveQuantity)<1?e="请填写数量":(t.giveQuantity=parseInt(t.giveQuantity),t.giveQuantity>parseInt(t.miniStock)&&(e=t.resName+",库存不足"))})),""!=e)return t.onoff=!0,void this._showToast(e);var n={resourceStores:this.resourceStores,description:this.description,acceptUserId:this.acceptUserId,acceptUserName:this.acceptUserName,communityId:(0,u.getCurrentCommunity)().communityId};(0,s.saveResourceStoreTransfer)(this,n).then((function(e){if(0==e.code)return t.onoff=!0,void uni.navigateBack({delta:1});t.onoff=!0}))},_removeItem:function(t,e){this.resourceStores.splice(t,1),this.$refs.selectresourcestaff.removeSelectedItem(e)},_storeHousesChange:function(t,e){this.$set(this.selectedStoreHousesList,t,e.target.value),this.resourceStores[t].shzId=this.storeHouses[this.selectedStoreHousesList[t]].shId},_showToast:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";uni.showToast({title:t,icon:e})}}};e.default=f},"5ae2":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showModel?i("v-uni-view",{staticClass:"select-single-resource"},[i("v-uni-view",[i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[t._v("员工")]),i("v-uni-picker",{attrs:{value:t.staffIndex,range:t.staffCloums,"range-key":"name"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.staffChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"picker"},[t._v(t._s(t.staffCloums[t.staffIndex].name))])],1)],1),i("v-uni-view",{staticClass:"flex flex-direction margin-top"},[i("v-uni-button",{staticClass:"cu-btn bg-green margin-tb-sm lg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t._save()}}},[t._v("确定")])],1),i("v-uni-view",{staticClass:"flex flex-direction margin-top"},[i("v-uni-button",{staticClass:"cu-btn bg-red margin-tb-sm lg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t._canel()}}},[t._v("取消")])],1)],1)],1):t._e()},s=[]},"5ddc":function(t,e,i){"use strict";i.r(e);var n=i("e492"),s=i("e530");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("be20");var o=i("828b"),r=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"11b00b64",null,!1,n["a"],void 0);e["default"]=r.exports},"614d":function(t,e,i){"use strict";i.r(e);var n=i("c450"),s=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=s.a},"7c1a":function(t,e,i){"use strict";var n=i("eaf5"),s=i.n(n);s.a},a4e1:function(t,e,i){"use strict";i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.queryOrgInfo=function(t,e){return new Promise((function(i,n){t.context.get({url:s.default.queryOrgInfo,data:e,success:function(t){i(t)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryStaffListInfo=function(t,e){return new Promise((function(i,n){t.context.get({url:s.default.queryStaffListInfo,data:e,success:function(t){i(t)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.uploadImageAsync=function(t,e){return new Promise((function(i,n){e.context.post({url:s.default.uploadImage,data:t,success:function(t){if(200==t.statusCode){var e=t.data;i(e)}},fail:function(t){uni.hideLoading(),uni.showToast({title:i18n.t("server_error"),icon:"none"})}})}))},i("bf0f");var s=n(i("f3d1"))},be20:function(t,e,i){"use strict";var n=i("cb71"),s=i.n(n);s.a},c07d:function(t,e,i){var n=i("c86c");e=n(!1),e.push([t.i,".select-single-resource[data-v-4516fd68]{position:fixed;top:%?100?%;left:0;background-color:#fff;width:100%;height:100%}.use-num-container[data-v-4516fd68]{display:flex;flex-direction:row}.use-num-input[data-v-4516fd68]{width:%?100?%;text-align:center;padding:0}.inc[data-v-4516fd68],.dec[data-v-4516fd68]{border:1px solid #000;border-radius:50%;width:%?40?%;height:%?40?%;text-align:center;line-height:%?40?%}",""]),t.exports=e},c450:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c223");var n=i("a4e1"),s=i("dae2"),a={components:{},data:function(){return{showModel:!1,communityId:"",orgIndex:0,selectedOrg:"",staffCloums:[{name:"请选择员工"}],staffIndex:0,selectedStaff:""}},props:{},watch:{},created:function(){},computed:{},mounted:function(){this.communityId=(0,s.getCurrentCommunity)().communityId,this._loadStaffList()},methods:{switchShow:function(){this.showModel=!this.showModel},_loadStaffList:function(){var t=this,e={page:1,row:50,communityId:this.communityId};(0,n.queryStaffListInfo)(this,e).then((function(e){t.staffCloums=t.staffCloums.concat(e.data.staffs)}))},orgChange:function(t){if(this.orgIndex=t.target.value,this.depCloums=[{orgName:"请选择部门"}],this.depIndex=0,this.selectedDep="",this.staffCloums=[{name:"请选择员工"}],this.staffIndex=0,this.selectedStaff="",0!=this.orgIndex){var e=this.orgCloums[this.orgIndex];this.selectedOrg=e,this._loadDepList()}},depChange:function(t){if(this.depIndex=t.target.value,this.staffCloums=[{name:"请选择员工"}],this.staffIndex=0,this.selectedStaff="",0!=this.depIndex){var e=this.depCloums[this.depIndex];this.selectedDep=e,this._loadStaffList()}},staffChange:function(t){if(this.staffIndex=t.target.value,this.selectedStaff="",0!=this.staffIndex){var e=this.staffCloums[this.staffIndex];this.selectedStaff=e}},_save:function(){""!=this.selectedStaff?(this.$emit("getStaffInfo",this.selectedStaff),this.showModel=!1):uni.showToast({title:"请选择员工",icon:"none"})},_canel:function(){this.showModel=!1}}};e.default=a},cb71:function(t,e,i){var n=i("2277");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var s=i("967d").default;s("08209acb",n,!0,{sourceMap:!1,shadowMode:!1})},e492:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return n}));var n={selectResourceStaff:i("117a").default,selectStaff:i("103f").default},s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticStyle:{"padding-bottom":"100rpx"}},[i("v-uni-view",{staticClass:"cu-bar bg-white search "},[i("v-uni-view",{staticClass:"action"},[i("v-uni-button",{staticClass:"cu-btn bg-gradual-green shadow-blur round",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t._openChooseResourceModel()}}},[t._v("选择物品")])],1)],1),i("v-uni-view",{staticClass:"margin-top"},t._l(t.resourceStores,(function(e,n){return i("v-uni-view",{key:n,staticClass:"cu-list menu-avatar "},[i("v-uni-view",{staticClass:"cu-item",staticStyle:{height:"180rpx"}},[i("v-uni-view",{staticClass:"content content-left",staticStyle:{width:"100%"}},[i("v-uni-view",{staticClass:"text-grey flex-around"},[i("v-uni-text",{staticClass:"ellip"},[t._v(t._s(e.resName)+"("+t._s(e.parentRstName)+">"+t._s(e.rstName)+")")]),i("v-uni-text",{staticClass:"item-remove bg-red text-df",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t._removeItem(n,e.resId)}}},[t._v("移除")])],1),i("v-uni-view",{staticClass:"text-gray flex-around text-df",staticStyle:{margin:"10rpx 0"}},[i("v-uni-text",[t._v("当前库存:")]),i("v-uni-text",[t._v(t._s(e.miniStock)+t._s(e.miniUnitCodeName))])],1),i("v-uni-view",{staticClass:"text-gray flex-around"},[i("v-uni-label",[t._v("数量("+t._s(e.miniUnitCodeName)+"):")]),i("v-uni-input",{staticClass:"use-number bg-gray",attrs:{type:"number",value:""},model:{value:e.giveQuantity,callback:function(i){t.$set(e,"giveQuantity",i)},expression:"item.giveQuantity"}})],1)],1)],1)],1)})),1),i("v-uni-view",{staticClass:"cu-bar bg-white search margin-top"},[i("v-uni-view",{staticClass:"action"},[i("v-uni-button",{staticClass:"cu-btn bg-gradual-green shadow-blur round",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t._openChooseStaffModel()}}},[t._v("选择员工")])],1)],1),t.acceptUserId?i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[t._v("员工")]),i("v-uni-input",{attrs:{disabled:"disabled"},model:{value:t.acceptUserName,callback:function(e){t.acceptUserName=e},expression:"acceptUserName"}})],1):t._e(),i("v-uni-view",{staticClass:"cu-form-group margin-top"},[i("v-uni-view",{staticClass:"title"},[t._v("转赠说明")]),i("v-uni-input",{attrs:{placeholder:"请输入转赠说明"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)],1),i("v-uni-view",{staticClass:"footer-step-fixed"},[i("v-uni-view",{staticClass:"step-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$preventClick(t.save)}}},[t._v("提交")])],1),i("select-resource-staff",{ref:"selectresourcestaff",on:{getResourceInfo:function(e){arguments[0]=e=t.$handleEvent(e),t._getResourceInfo.apply(void 0,arguments)}}}),i("select-staff",{ref:"selectstaff",on:{getStaffInfo:function(e){arguments[0]=e=t.$handleEvent(e),t._getStaffInfo.apply(void 0,arguments)}}})],1)},a=[]},e530:function(t,e,i){"use strict";i.r(e);var n=i("3c26"),s=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=s.a},eaf5:function(t,e,i){var n=i("c07d");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var s=i("967d").default;s("1af88e80",n,!0,{sourceMap:!1,shadowMode:!1})}}]);