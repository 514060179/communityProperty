(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repairDispatch-repairDispatch"],{1756:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.modalData.showModal,expression:"modalData.showModal"}],staticClass:"modalInputBg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.modalData.showModal=!1}}},[a("v-uni-view",{staticClass:"modalInput"},[a("v-uni-view",{staticClass:"modalDiv",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.Bubbling.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"title"},[t._v(t._s(t.modalData.title))]),a("v-uni-view",{staticClass:"body"},[a("v-uni-input",{attrs:{type:"text",value:"",placeholder:t.modalData.text},model:{value:t.inputVal,callback:function(e){t.inputVal=e},expression:"inputVal"}})],1),a("v-uni-view",{staticClass:"bottom"},[a("v-uni-view",{staticClass:"bottomCancel",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.modalData.showModal=!1}}},[t._v("取消")]),a("v-uni-view",{staticClass:"bottomDefine",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.onDefine.apply(void 0,arguments)}}},[t._v("确定")])],1)],1)],1)],1)},i=[]},3121:function(t,e,a){"use strict";a("6a54");var n=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.appraiseRepair=function(t,e){return new Promise((function(a,n){if(""!=t.remark)if(""!=t.repairId){var r={repairId:t.repairId,repairType:t.repairType,repairChannel:t.repairChannel,publicArea:t.publicArea,communityId:t.communityId,context:t.remark};t.context.post({url:i.default.appraiseRepairNew,data:r,success:function(t){a(t)},fail:function(t){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},e)}else uni.showToast({title:o.default.t("wbhbxxxx"),icon:"none"});else uni.showToast({title:o.default.t("qtxpjnrs"),icon:"none"})}))},e.dispatchRepair=function(t,e){return new Promise((function(a,n){var s={staffId:t.staffId,staffName:t.staffName,context:t.content,repairId:t.repairId,repairType:t.repairType,action:t.action,communityId:(0,r.getCurrentCommunity)().communityId,photos:[],userId:t.userId,userName:t.userName},u=t.photos;u.forEach((function(t){s.photos.push({photo:t})}));var c="";""==s.context?c=o.default.t("please_enter_handling_comments"):""==s.staffId||""==s.staffName?c=o.default.t("qtxsf1"):""==s.repairId?c=o.default.t("errorData"):"TRANSFER"==s.action&&s.userId==s.staffId&&(c=o.default.t("bnzdgzj")),""==c?t.context.post({url:i.default.repairDispatch,data:s,success:function(t){a(t)},fail:function(t){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},e):wx.showToast({title:c,icon:"none",duration:2e3})}))},e.finishRepair=function(t,e){return new Promise((function(a,n){var s={feeFlag:t.feeFlag,context:t.content,repairId:t.repairId,repairChannel:t.repairChannel,publicArea:t.publicArea,maintenanceType:t.feeFlag,repairType:t.repairType,action:t.action,communityId:(0,r.getCurrentCommunity)().communityId,beforeRepairPhotos:[],afterRepairPhotos:[],repairObjType:t.repairObjType,userId:t.userId,userName:t.userName,storeId:t.storeId,choosedGoodsList:t.resourceStoreInfo,totalPrice:t.amount,payType:t.payType},u=t.beforeRepairPhotos;u.forEach((function(t){s.beforeRepairPhotos.push({photo:t})}));var c=t.afterRepairPhotos;c.forEach((function(t){s.afterRepairPhotos.push({photo:t})}));var l="";if(s.feeFlag?""==s.context?l=o.default.t("please_enter_handling_comments"):s.beforeRepairPhotos.length<=0||s.afterRepairPhotos.length<=0?l=o.default.t("qsctptt"):""==s.repairId?l=o.default.t("errorData"):("1001"==s.maintenanceType||"1003"==s.maintenanceType)&&s.choosedGoodsList.length<1?l=o.default.t("qxzwppp"):"1001"==s.maintenanceType&&""==s.payType?l=o.default.t("qxzzffssss"):("1001"==s.maintenanceType||"1003"==s.maintenanceType)&&s.choosedGoodsList.length>=1&&s.choosedGoodsList.forEach((function(t){(!t.useNumber||t.useNumber<1)&&(l=o.default.t("spslywww")),"1001"==s.maintenanceType&&(!t.price||t.price<0)&&(l=o.default.t("spjgywww"))})):l=o.default.t("qxzlxx"),""!=l)return wx.showToast({title:l,icon:"none",duration:2e3}),void(t.onoff=!0);"1002"!=s.maintenanceType&&"1004"!=s.maintenanceType||(s.useNumber=0,s.choosedGoodsList=[]),t.context.post({url:i.default.repairFinish,data:s,success:function(e){t.onoff=!0,a(e)},fail:function(e){t.onoff=!0,wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},e)}))},e.loadRepairStaff=function(t,e,a){return new Promise((function(n,r){t.context.get({url:i.default.listRepairTypeUsers,data:e,success:function(t){n(t)},fail:function(t){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},e.queryDictInfo=function(t,e,a){return new Promise((function(n,r){t.context.get({url:i.default.queryDictInfo,data:e,success:function(t){n(t.data)},fail:function(t){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},e.queryRepairInfo=function(t,e,a){return new Promise((function(n,r){t.context.get({url:i.default.queryRepairInfo,data:e,success:function(t){n(t.data)},fail:function(t){wx.showToast({title:"",icon:"none",duration:2e3})}},a)}))},e.queryResourceStoreResName=function(t,e,a){return new Promise((function(n,r){t.context.get({url:i.default.queryResourceStoreResName,data:e,success:function(t){n(t)},fail:function(t){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},e.repairStart=function(t,e,a){return new Promise((function(n,r){t.context.post({url:i.default.repairStart,data:e,success:function(t){n(t.data)},fail:function(t){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},e.repairStop=function(t,e,a){return new Promise((function(n,r){t.context.post({url:i.default.repairStop,data:e,success:function(t){n(t.data)},fail:function(t){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},e.replyRepairAppraise=function(t,e,a){return new Promise((function(n,r){e.context.post({url:i.default.replyRepairAppraise,data:t,success:function(t){n(t.data)},fail:function(t){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},a("bf0f"),a("2797"),a("aa9c");var i=n(a("f0de")),r=a("2d9e"),o=n(a("3e79"))},"3fcb":function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={props:{modalData:{type:Object}},data:function(){return{inputVal:""}},methods:{onDefine:function(){this.inputVal?(this.modalData.showModal=!1,this.$emit("dataInput",this.inputVal),this.inputVal=""):uni.showToast({title:"请填写"+this.modalData.title,icon:"none"})},Bubbling:function(){}}};e.default=n},5219:function(t,e,a){"use strict";var n=a("d067"),i=a.n(n);i.a},5773:function(t,e,a){"use strict";a.r(e);var n=a("1756"),i=a("7a29");for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a("5219");var o=a("828b"),s=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"29eef080",null,!1,n["a"],void 0);e["default"]=s.exports},"7a29":function(t,e,a){"use strict";a.r(e);var n=a("3fcb"),i=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e["default"]=i.a},"7b3f":function(t,e,a){"use strict";a.r(e);var n=a("c0ea"),i=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e["default"]=i.a},"7bff":function(t,e,a){"use strict";a.r(e);var n=a("ba82"),i=a("7b3f");for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);var o=a("828b"),s=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"23e9261c",null,!1,n["a"],void 0);e["default"]=s.exports},"9ef9":function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.getFileType=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t.split("."),a=e[e.length-1];if(!a)return"";a=a.toLocaleLowerCase();var n=["png","jpg","jpeg","bmp","gif","webp"];if(n.includes(a))return"image";var i=["mp4","m4v"];if(i.includes(a))return"video";var r=["mp3","m4a","wav","aac"];if(r.includes(a))return"audio";var o=["pdf","doc","docx","xls","xlsx","ppt","pptx","txt","plain"];return o.includes(a)?"office":"unknown"},e.preventClick=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=this;a.onoff?(a.onoff=!1,t(e)):uni.showToast({title:"操作过于频繁",icon:"none"})},a("4626")},ba82:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return n}));var n={uniLoadMore:a("bcc2").default,noDataPage:a("31c4").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticClass:"cu-bar bg-white search "},[a("v-uni-view",{staticClass:"search-form round"},[a("v-uni-text",{staticClass:"cuIcon-search"}),a("v-uni-input",{attrs:{type:"text",placeholder:t.$t("enter_reporter"),"confirm-type":"search"},model:{value:t.repairName,callback:function(e){t.repairName=e},expression:"repairName"}})],1),a("v-uni-view",{staticClass:"search-form round"},[a("v-uni-text",{staticClass:"cuIcon-search"}),a("v-uni-picker",{attrs:{value:t.repairStatesIndex,range:t.repairStates,"range-key":"name"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.repairStatesChange.apply(void 0,arguments)}}},[a("v-uni-view",[t._v(t._s(t.repairStates[t.repairStatesIndex].name))])],1)],1),a("v-uni-view",{staticClass:"action"},[a("v-uni-button",{staticClass:"cu-btn bg-gradual-blue shadow-blur round",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$preventClick(t._searchRepair)}}},[t._v("搜索")])],1)],1),0==t.noData?a("v-uni-view",[t._l(t.myOrders,(function(e,n){return a("v-uni-view",{key:n,staticClass:"bg-white margin-top margin-right-xs radius margin-left-xs padding"},[a("v-uni-view",{staticClass:"flex padding-bottom-xs solid-bottom justify-between"},[a("v-uni-view",[t._v(t._s(e.repairId))]),a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.tel))])],1),a("v-uni-view",{staticClass:"flex margin-top justify-between"},[a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.$t("repair_type")))]),a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.repairTypeName))])],1),a("v-uni-view",{staticClass:"flex margin-top-xs justify-between"},[a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.$t("reporter")))]),a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.repairName))])],1),a("v-uni-view",{staticClass:"flex margin-top-xs justify-between"},[a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.$t("location")))]),a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.repairObjName))])],1),a("v-uni-view",{staticClass:"flex margin-top-xs justify-between"},[a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.$t("appointment_time")))]),a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.appointmentTime))])],1),a("v-uni-view",{staticClass:"flex margin-top-xs justify-between"},[a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.$t("status")))]),"1800"!=e.state||"001"!=e.returnVisitFlag&&"002"!=e.returnVisitFlag?a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.stateName))]):a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.stateName)+"(定时任务处理)")])],1),a("v-uni-view",{staticClass:"flex margin-top-xs justify-between"},[a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.$t("repair_content")))]),a("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.context))])],1),a("v-uni-view",{staticClass:"solid-top flex justify-end margin-top padding-top-sm "},[a("v-uni-button",{staticClass:"cu-btn sm line-gray",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.repairDetail(e)}}},[t._v(t._s(t.$t("details")))]),"2001"==e.state?a("v-uni-view",[a("v-uni-button",{staticClass:"cu-btn sm bg-blue margin-left",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.startRepair(e)}}},[t._v(t._s(t.$t("start")))])],1):a("v-uni-view",["1100"==e.state||"1200"==e.state||"1300"==e.state?a("v-uni-button",{staticClass:"cu-btn sm bg-orange margin-left",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.dealRepair(e,"TRANSFER")}}},[t._v(t._s(t.$t("transfer_order")))]):t._e(),"1100"==e.state||"1200"==e.state||"1300"==e.state?a("v-uni-button",{staticClass:"cu-btn sm bg-orange margin-left",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.stopRepair(e)}}},[t._v(t._s(t.$t("pause")))]):t._e(),"-1"!=e.preStaffId?a("v-uni-button",{staticClass:"cu-btn sm bg-red margin-left",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.dealRepair(e,"BACK")}}},[t._v(t._s(t.$t("chargeback")))]):t._e(),"1100"==e.state||"1200"==e.state||"1300"==e.state?a("v-uni-button",{staticClass:"cu-btn sm bg-blue margin-left",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.dealRepair(e,"FINISH")}}},[t._v(t._s(t.$t("close_case")))]):t._e(),"1800"==e.state&&"003"==e.returnVisitFlag&&t.checkAuth("502021040151320003")?a("v-uni-button",{staticClass:"cu-btn sm bg-blue margin-left",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.dealAppraise(e)}}},[t._v(t._s(t.$t("return_visit")))]):t._e()],1)],1)],1)})),a("uni-load-more",{attrs:{status:t.loadingStatus,"content-text":t.loadingContentText}})],2):a("v-uni-view",[a("no-data-page")],1),a("myModal",{attrs:{modalData:t.modal},on:{dataInput:function(e){arguments[0]=e=t.$handleEvent(e),t.dataInput.apply(void 0,arguments)}}})],1)},r=[]},c0ea:function(t,e,a){"use strict";a("6a54");var n=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("c223");var i=n(a("31c4")),r=n(a("5773")),o=n(a("bcc2")),s=n(a("f0de")),u=a("2d9e"),c=a("3121"),l=a("9ef9"),d=n(a("9b8e"));d.default.prototype.$preventClick=l.preventClick;var p={data:function(){var t=this,e=function(e){return t.$t(e)};return{onoff:!0,orderImg:s.default.baseUrl+"img/order.png",myOrders:[],orders:[],storeId:"",noData:!1,page:1,loadingStatus:"loading",loadingContentText:{contentdown:e("pull_up_to_load_more"),contentrefresh:e("loading"),contentnomore:e("no_more")},repairStates:[{name:e("please_select")}],repairStatesIndex:0,repairState:"",repairName:"",modal:{showModal:!1,title:e("pause_reason"),text:e("please_enter_pause_reason")}}},components:{noDataPage:i.default,uniLoadMore:o.default,myModal:r.default},onLoad:function(){this.java110Context.onLoad(),this.loadRepairState()},onShow:function(){var t=this.java110Context.getUserInfo(),e=t.storeId;this.storeId=e,this.myOrders=[],this.page=1,this._loadMyModify()},onReachBottom:function(){"noMore"!=this.loadingStatus&&this._loadMyModify()},methods:{_searchRepair:function(){this.myOrders=[],this.page=1,this._loadMyModify()},loadRepairState:function(){var t=this;(0,c.queryDictInfo)(this,{name:"r_repair_pool",type:"state"},0==this.repairStates.length).then((function(e){t.repairStates=t.repairStates.concat(e)}))},repairStatesChange:function(t){if(this.repairStatesIndex=t.target.value,0!=this.repairStatesIndex){var e=this.repairStates[this.repairStatesIndex];this.repairState=e.statusCd}else this.repairState=""},checkAuth:function(t){return this.java110Context.hasPrivilege(t)},_loadMyModify:function(){this.loadingStatus="more";var t=this,e=this.java110Context.getUserInfo(),a=(e.storeId,{page:t.page,row:15,userId:e.userId,communityId:(0,u.getCurrentCommunity)().communityId,repairName:t.repairName,state:t.repairState});this.java110Context.request({url:s.default.listStaffRepairs,header:t.java110Context.getHeaders(),method:"GET",data:a,success:function(e){var a=e.data;if(0!=a.code)return uni.showToast({icon:"none",title:a.msg}),void(t.onoff=!0);var n=a.data;return t.myOrders=t.myOrders.concat(n),t.page++,t.myOrders.length<1?(t.noData=!0,void(t.onoff=!0)):(t.noData=!1,t.myOrders.length==a.total?(t.loadingStatus="noMore",void(t.onoff=!0)):void 0)},fail:function(e){wx.showToast({title:t.$t("server_error"),icon:"none",duration:2e3})}},0==this.myOrders.length)},repairDetail:function(t){uni.navigateTo({url:"/pages/repairDetail/repairDetail?repairId="+t.repairId+"&storeId="+this.storeId})},dealRepair:function(t,e){console.log("item",t),uni.navigateTo({url:"/pages/repairHandle/repairHandle?action="+e+"&repairId="+t.repairId+"&repairType="+t.repairType+"&preStaffId="+t.preStaffId+"&preStaffName="+t.preStaffName+"&repairObjType="+t.repairObjType+"&publicArea="+t.publicArea+"&repairChannel="+t.repairChannel})},dealAppraise:function(t){console.log(t),this.context.navigateTo({url:"/pages/appraiseRepair/appraiseRepair?repairId="+t.repairId+"&repairType="+t.repairType+"&preStaffId="+t.preStaffId+"&preStaffName="+t.preStaffName+"&repairObjType="+t.repairObjType+"&repairType="+t.repairType+"&repairChannel="+t.repairChannel+"&publicArea="+t.publicArea+"&communityId="+t.communityId})},startRepair:function(t){var e=this;uni.showModal({title:"提示",content:this.$t("confirm_start_repair"),success:function(a){a.confirm?(0,c.repairStart)(e,t,!0).then((function(t){0==t.code&&(e.myOrders=[],e.page=1,e._loadMyModify()),uni.showToast({title:t.msg})})):a.cancel&&console.log("用户点击取消")}})},stopRepair:function(t){this.actItem=t,this.modal.showModal=!0},dataInput:function(t){var e=this,a={communityId:this.actItem.communityId,remark:t,repairId:this.actItem.repairId,repairType:this.actItem.repairType};(0,c.repairStop)(this,a,!0).then((function(t){0==t.code&&(e.myOrders=[],e.page=1,e._loadMyModify()),uni.showToast({title:t.msg})}))}}};e.default=p},d067:function(t,e,a){var n=a("d6db6");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("967d").default;i("d70cb8a8",n,!0,{sourceMap:!1,shadowMode:!1})},d6db6:function(t,e,a){var n=a("c86c");e=n(!1),e.push([t.i,".modalInputBg[data-v-29eef080]{position:fixed;z-index:999;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.2)}.modalInput[data-v-29eef080]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.modalDiv[data-v-29eef080]{width:86%;height:auto;background-color:#fff;border-radius:%?10?%}.modalInput .modalDiv .title[data-v-29eef080]{text-align:center;padding:%?48?% 0 0 0;letter-spacing:%?2?%;font-size:%?44?%}.modalInput .modalDiv .body[data-v-29eef080]{width:86%;height:%?80?%;line-height:%?80?%;margin:%?72?% auto;border:%?2?% solid #dcdee0;box-shadow:0 0 10px 0 rgba(0,0,0,.08);padding:0 3%;box-sizing:border-box;border-radius:%?10?%}.modalInput .modalDiv .body uni-input[data-v-29eef080]{height:100%}.modalInput .modalDiv .bottom[data-v-29eef080]{display:flex;align-items:center;height:%?88?%;border-top:%?2?% solid #dcdee0;box-shadow:0 0 10px 0 rgba(0,0,0,.08)}.modalInput .modalDiv .bottom uni-view[data-v-29eef080]{flex:1;text-align:center;font-size:%?30?%;letter-spacing:%?2?%;height:100%;line-height:%?88?%}.modalInput .modalDiv .bottom .bottomCancel[data-v-29eef080]{border-right:%?2?% solid #dcdee0}.modalInput .modalDiv .bottom .bottomDefine[data-v-29eef080]{color:#3f83f7}",""]),t.exports=e}}]);