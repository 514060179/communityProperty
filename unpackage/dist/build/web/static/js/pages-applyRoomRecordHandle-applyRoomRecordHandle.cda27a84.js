(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-applyRoomRecordHandle-applyRoomRecordHandle"],{"086a":function(t,e,n){"use strict";var o=n("f5f5"),i=n.n(o);i.a},"10c4":function(t,e,n){"use strict";function o(t,e){var n=new Image;n.src=t,n.onload=function(){var t=this.height,n=this.width,o=document.createElement("canvas"),i=o.getContext("2d"),a=document.createAttribute("width");a.nodeValue=n;var s=document.createAttribute("height");s.nodeValue=t,o.setAttributeNode(a),o.setAttributeNode(s),i.drawImage(this,0,0,n,t);var r=o.toDataURL("image/jpeg",.3);o=null,e(r)}}n("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.base64ToBlob=function(t){var e=t.split(","),n=e[0].match(/:(.*?);/)[1],o=atob(e[1]),i=o.length,a=new Uint8Array(i);while(i--)a[i]=o.charCodeAt(i);return new Blob([a],{type:n})},e.translate=function(t,e){o(t,e)},e.translateH5=o,n("5c47"),n("2c10"),n("c9b5"),n("15d1"),n("d5c6"),n("5a56"),n("f074"),n("4db2"),n("bf0f"),n("c976"),n("4d8f"),n("7b97"),n("668a"),n("c5b7"),n("8ff5"),n("2378"),n("641a"),n("64e0"),n("cce3"),n("efba"),n("d009"),n("bd7d"),n("7edd"),n("d798"),n("f547"),n("5e54"),n("b60a"),n("8c18"),n("12973"),n("f991"),n("198e"),n("8557"),n("63b1"),n("1954"),n("1cf1")},"1da7":function(t,e,n){"use strict";n.r(e);var o=n("c1dc"),i=n("8c55");for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("086a");var s=n("828b"),r=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"251dd24a",null,!1,o["a"],void 0);e["default"]=r.exports},"353b":function(t,e,n){var o=n("c86c");e=o(!1),e.push([t.i,".block__title[data-v-251dd24a]{margin:0;font-weight:400;font-size:14px;color:rgba(69,90,100,.6);padding:%?40?% %?30?% %?20?%}",""]),t.exports=e},"37c9":function(t,e,n){"use strict";n("6a54");var o=n("f5bd").default,i=n("3639").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("64aa"),n("bf0f"),n("2797"),n("5ef2"),n("aa9c"),n("dd2b");var a=i(n("10c4")),s=o(n("91c2")),r=n("a4e1"),u=n("8196"),c=(u.factory,{name:"vc-upload",data:function(){return{photos:[],imgList:[],photoUrl:s.default.commonBaseUrl+"/callComponent/download/getFile/file",sendImgList:[]}},props:{communityId:{type:String,default:""},title:{type:String,default:"image_upload"},maxPhotoNum:{type:Number,default:1},count:{type:Number,default:1},sizeType:{type:Array,default:function(){return["original","compressed"]}},sourceType:{type:Array,default:function(){return["album","camera"]}},canEdit:{type:Boolean,default:!0}},watch:{photos:function(t){this.sendData()},deep:!0},mounted:function(){this._initImageList(this.sendImgList)},methods:{_initImageList:function(t){var e=this;this.sendImgList=t,this.sendImgList.forEach((function(t,n){if(t.indexOf("base64,")>-1&&e.imgList.push(_photo),t.indexOf("https")>-1||t.indexOf("http")>-1||t.indexOf(e.photoUrl)>-1){e.imgList.push(t);var o=e._getUrlParams(t);o["fileId"]&&e.photos.push({fileId:o["fileId"],url:t})}else{var i=e.photoUrl+"?fileId="+t+"&communityId=-1&time="+new Date;e.imgList.push(i),e.photos.push({fileId:t,url:i})}})),console.log(this.imgList)},sendData:function(){this.$emit("sendImagesData",this.photos)},_getUrlParams:function(t){if(t.indexOf("?")<0)return{fileId:t.substring(t.indexOf("img"))};for(var e=t.split("?")[1],n={},o=e.split("&"),i=0,a=o.length;i<a;i++){var s=o[i].split("=");n[s[0]]=s[1]}return n},deleteImage:function(t){this.imgList.splice(t,1),this.photos.splice(t,1)},ChooseImage:function(){var t=this;wx.chooseImage({count:this.count,sizeType:this.sizeType,sourceType:this.sourceType,success:function(e){var n=e.tempFilePaths[0];t.imgList.push(n),t.$forceUpdate(),a.translate(n,(function(e){var n={uploadFile:e,communityId:t.communityId};(0,r.uploadImageAsync)(n,t).then((function(e){t.photos.push(e)}))}))}})},preview:function(t){var e=this.imgList;e.length<1||(e.forEach((function(t,n){var o=t.indexOf("/callComponent");0==o&&(e[n]=s.default.commonBaseUrl+t)})),uni.previewImage({current:t,urls:e}))}}});e.default=c},"3d9b":function(t,e,n){"use strict";n.r(e);var o=n("9f50"),i=n("d849");for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);var s=n("828b"),r=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"527ee613",null,!1,o["a"],void 0);e["default"]=r.exports},"73f9":function(t,e,n){"use strict";n("6a54");var o=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.cutApplyRoomDiscountRecord=function(t,e){return new Promise((function(n,o){t.context.post({url:i.default.cutApplyRoomDiscountRecord,data:e,success:function(t){0==t.data.code?n():wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.loadApplyRooms=function(t,e){return new Promise((function(n,o){t.context.get({url:i.default.listApplyRoom,data:e,success:function(e){t.onoff=!0,0==e.data.code?n(e.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.loadFeeDiscount=function(t,e){return new Promise((function(n,o){t.context.get({url:i.default.queryFeeDiscount,data:e,success:function(t){0==t.data.code?n(t.data.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryApplyRoomRecord=function(t,e){return new Promise((function(n,o){t.context.get({url:i.default.listApplyRoomDiscountRecord,data:e,success:function(t){0==t.data.code?n(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryApplyRoomRecordDetail=function(t,e){return new Promise((function(n,o){t.context.get({url:i.default.listApplyRoomDiscountRecordDetail,data:e,success:function(t){0==t.data.code?n(t.data.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryDictInfo=function(t,e){return new Promise((function(n,o){t.context.get({url:i.default.queryDictInfo,data:e,success:function(t){n(t.data)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.saveApplyRoomDiscountRecord=function(t,e){return new Promise((function(n,o){t.context.post({url:i.default.saveApplyRoomDiscountRecord,data:e,success:function(t){0==t.data.code?n():wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.uploadCheckUpdate=function(t,e){return new Promise((function(n,o){t.context.post({url:i.default.updateApplyRoomDiscount,data:e,success:function(t){0==t.data.code?n():wx.showToast({title:t.data.msg,icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.uploadReviewUpdate=function(t,e){return new Promise((function(n,o){t.context.post({url:i.default.updateReviewApplyRoomDiscount,data:e,success:function(t){0==t.data.code?n():wx.showToast({title:t.data.msg,icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},n("bf0f");var i=o(n("f3d1"))},"8c55":function(t,e,n){"use strict";n.r(e);var o=n("c36b"),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=i.a},"9f50":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("v-uni-view",{staticClass:"cu-bar bg-white "},[n("v-uni-view",{staticClass:"action"},[t._v(t._s(t.title))]),t.canEdit?n("v-uni-view",{staticClass:"action"},[t._v(t._s(t.imgList.length)+"/"+t._s(t.maxPhotoNum))]):t._e()],1),n("v-uni-view",{staticClass:"cu-form-group"},[n("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[t._l(t.imgList,(function(e,o){return n("v-uni-view",{staticClass:"bg-img",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.preview(o)}}},[n("v-uni-image",{attrs:{src:e,mode:"aspectFill"}}),t.canEdit?n("v-uni-view",{staticClass:"cu-tag bg-red",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.deleteImage(o)}}},[n("v-uni-text",{staticClass:"cuIcon-close"})],1):t._e()],1)})),t.canEdit&&t.imgList.length<t.maxPhotoNum?n("v-uni-view",{staticClass:"solids",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ChooseImage.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):t._e()],2)],1)],1)},i=[]},a4e1:function(t,e,n){"use strict";n("6a54");var o=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.queryOrgInfo=function(t,e){return new Promise((function(n,o){t.context.get({url:i.default.queryOrgInfo,data:e,success:function(t){n(t)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryStaffListInfo=function(t,e){return new Promise((function(n,o){t.context.get({url:i.default.queryStaffListInfo,data:e,success:function(t){n(t)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.uploadImageAsync=function(t,e){return new Promise((function(n,o){e.context.post({url:i.default.uploadImage,data:t,success:function(t){if(200==t.statusCode){var e=t.data;n(e)}},fail:function(t){uni.hideLoading(),uni.showToast({title:i18n.t("server_error"),icon:"none"})}})}))},n("bf0f");var i=o(n("f3d1"))},c1dc:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("v-uni-view",{staticClass:"cu-form-group margin-top"},[n("v-uni-textarea",{attrs:{placeholder:"请输入处理意见"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("v-uni-view",{staticClass:"cu-form-group margin-top"},[n("v-uni-picker",{attrs:{value:t.violationIndex,range:t.violations,"range-key":"name"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.violationChange.apply(void 0,arguments)}}},[n("v-uni-view",[t._v(t._s(t.violations[t.violationIndex].name))])],1)],1),n("v-uni-view",{staticClass:"block__title"},[t._v("相关图片")]),n("uploadImageAsync",{ref:"vcUploadRef",attrs:{communityId:t.communityId,maxPhotoNum:t.uploadImage.maxPhotoNum,canEdit:t.uploadImage.canEdit,title:t.uploadImage.imgTitle},on:{sendImagesData:function(e){arguments[0]=e=t.$handleEvent(e),t.sendImagesData.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"flex flex-direction margin-top"},[n("v-uni-button",{staticClass:"cu-btn bg-green margin-tb-sm lg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t._dispatchRecord()}}},[t._v("提交")])],1)],1)},i=[]},c36b:function(t,e,n){"use strict";n("6a54");var o=n("f5bd").default,i=n("3639").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("bf0f"),n("2797"),n("aa9c");var a=n("73f9"),s=n("dae2"),r=(i(n("10c4")),o(n("3d9b"))),u={data:function(){return{applyRoomInfo:[],imgList:[],photos:[],videoName:"",tempFilePath:"",content:"",communityId:"",violations:[{name:"请选择是否违规"},{name:"是",value:"true"},{name:"否",value:"false"}],violationIndex:0,violation:"",uploadImage:{maxPhotoNum:4,imgTitle:"图片上传",canEdit:!0}}},components:{uploadImageAsync:r.default},onLoad:function(t){this.java110Context.onLoad();this.communityId=(0,s.getCurrentCommunity)().communityId,this.applyRoomInfo=JSON.parse(t.apply)},methods:{sendImagesData:function(t){var e=this;this.photos=[],t.length>0&&t.forEach((function(t){e.photos.push(t.fileId)}))},violationChange:function(t){if(this.violationIndex=t.target.value,0!=this.violationIndex){var e=this.violations[this.violationIndex];this.violation=e.value}else this.violation=""},_dispatchRecord:function(){uni.showLoading({title:"上传中..."});var t={ardId:this.applyRoomInfo.ardId,roomId:this.applyRoomInfo.roomId,roomName:this.applyRoomInfo.roomName,state:this.applyRoomInfo.state,stateName:this.applyRoomInfo.stateName,photos:this.photos,videoName:"",remark:this.content,detailType:"1001",communityId:this.communityId,examineRemark:"",isTrue:this.violation},e="";""==t.remark?e="请填写处理意见":""==t.isTrue&&(e="请选择是否违规"),""==e?(0,a.saveApplyRoomDiscountRecord)(this,t).then((function(){uni.showToast({title:"保存成功"}),setTimeout((function(){uni.navigateBack({delta:1})}),1e3)})):uni.showToast({title:e,icon:"none"})}}};e.default=u},d849:function(t,e,n){"use strict";n.r(e);var o=n("37c9"),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=i.a},f5f5:function(t,e,n){var o=n("353b");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=n("967d").default;i("681882bc",o,!0,{sourceMap:!1,shadowMode:!1})}}]);