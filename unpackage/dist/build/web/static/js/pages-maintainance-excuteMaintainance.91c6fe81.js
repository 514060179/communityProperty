(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-maintainance-excuteMaintainance"],{"0f24":function(t,n,a){var e=a("c86c");n=e(!1),n.push([t.i,".block__title[data-v-21f0f65a]{margin:0;font-weight:400;font-size:14px;color:rgba(69,90,100,.6);padding:%?40?% %?30?% %?20?%}",""]),t.exports=n},"2f4a":function(t,n,a){"use strict";var e=a("a68f"),i=a.n(e);i.a},3565:function(t,n,a){"use strict";a.d(n,"b",(function(){return e})),a.d(n,"c",(function(){return i})),a.d(n,"a",(function(){}));var e=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("v-uni-view",[a("v-uni-view",{staticClass:"block__title"},[t._v(t._s(t.planName))]),a("v-uni-view",{staticClass:"cu-timeline margin-left-xs margin-right-xs"},[a("v-uni-view",{staticClass:"cu-time"},[t._v("设备")]),t._l(t.taskDetails,(function(n,e){return a("v-uni-view",{key:e,staticClass:"cu-item cuIcon-noticefill",class:"20200407"==n.state?"text-green":""},[a("v-uni-view",{staticClass:"content shadow-blur",class:"20200407"==n.state?"bg-green":""},[t._v(t._s(n.machineName)),a("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:"20200407"!=n.state&&n.pointStartTime&&n.pointEndTime,expression:"item.state != '20200407' && item.pointStartTime && item.pointEndTime"}]},[t._v("("+t._s(n.pointStartTime)+" - "+t._s(n.pointEndTime)+")")])],1),"20200407"==n.state?a("v-uni-view",{staticClass:"bg-green content"},[a("v-uni-text",[t._v("处理意见：")]),t._v(t._s(n.description))],1):t._e(),"20200407"==n.state&&n.photos.length>0?a("v-uni-view",{staticClass:"margin-top grid text-center col-3 grid-square"},t._l(n.photos,(function(n,i){return a("v-uni-view",{key:i},[a("v-uni-image",{attrs:{mode:"scaleToFill","data-url":n.url,src:n.url},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.preview(e,i)}}})],1)})),1):t._e(),"20200407"!=n.state?a("v-uni-view",{staticClass:"text-right"},[a("v-uni-button",{staticClass:"cu-btn  line-green block margin-tb-sm lg ",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t._excuteMaintaainance(n)}}},[a("v-uni-text",{staticClass:"cuIcon-upload"}),t._v("保养")],1)],1):t._e()],1)}))],2)],1)},i=[]},"4ac1":function(t,n,a){"use strict";a.r(n);var e=a("3565"),i=a("5253");for(var s in i)["default"].indexOf(s)<0&&function(t){a.d(n,t,(function(){return i[t]}))}(s);a("2f4a");var o=a("828b"),c=Object(o["a"])(i["default"],e["b"],e["c"],!1,null,"21f0f65a",null,!1,e["a"],void 0);n["default"]=c.exports},5253:function(t,n,a){"use strict";a.r(n);var e=a("a9f1"),i=a.n(e);for(var s in e)["default"].indexOf(s)<0&&function(t){a.d(n,t,(function(){return e[t]}))}(s);n["default"]=i.a},"7ecf":function(t,n,a){"use strict";a("6a54");var e=a("f5bd").default;Object.defineProperty(n,"__esModule",{value:!0}),n.UpdateMaintainanceTask=function(t,n){return new Promise((function(a,e){t.context.post({url:i.default.UpdateMaintainanceTask,data:n,success:function(t){a(t.data)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},n.queryDictInfo=function(t,n){return new Promise((function(a,e){t.context.get({url:i.default.queryDictInfo,data:n,success:function(t){a(t.data)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},n.queryMaintainanceItemTitle=function(t,n){return new Promise((function(a,e){t.context.get({url:i.default.listMaintainanceItem,data:n,success:function(t){var n=t.data;0!=n.code?e(n.msg):a(n.data)},fail:function(t){e(t)}})}))},n.queryMaintainanceTask=function(t,n){return new Promise((function(a,e){t.context.get({url:i.default.listMaintainanceTask,data:n,success:function(t){var n=t.data;if(0==n.code)return t.data.data.forEach((function(t,n){t.timeStr=t.planInsTime.replace(/:\d{1,2}$/," ")})),void a(t.data.data);e(n.msg)},fail:function(t){e(t)}})}))},n.queryMaintainanceTaskDetail=function(t,n){return new Promise((function(a,e){t.context.get({url:i.default.listMaintainanceTaskDetail,data:n,success:function(t){var n=t.data;if(0==n.code)return n.data.forEach((function(t){})),void a(n.data);e(n.msg)},fail:function(t){e(t)}})}))},n.updateMaintainanceTaskDetail=function(t,n){var a="";""==n.taskId?a="数据异常，保养任务为空":""==n.taskDetailId?a="数据异常，保养任务详情为空":""==n.machineId?a="设备不能为空":""==n.machineName?a="设备名称不能为空":""==n.patrolType?a="保养情况不能为空":""==n.description?a="保养说明不能为空":""==n.userId?a="数据异常，保养人为空":n.photos.length<=0&&(a="请上传保养图片");if(""!=a)return void wx.showToast({title:a,icon:"none",duration:2e3});return uni.showLoading({title:"请稍后..."}),new Promise((function(a,e){t.context.post({url:i.default.updateMaintainanceTaskDetail,data:n,success:function(t){a(t.data),uni.hideLoading()},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3}),uni.hideLoading()}})}))},a("bf0f"),a("2797"),a("5c47"),a("a1c1"),a("01a2"),a("e39c");var i=e(a("f3d1"))},a68f:function(t,n,a){var e=a("0f24");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var i=a("967d").default;i("229e3e04",e,!0,{sourceMap:!1,shadowMode:!1})},a9f1:function(t,n,a){"use strict";a("6a54");var e=a("f5bd").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,a("bf0f"),a("2797"),a("aa9c");var i=a("dae2"),s=(e(a("f3d1")),a("7ecf")),o={data:function(){return{taskId:"",planName:"",scroll:0,communityId:"",userId:"",userName:"",taskDetails:[]}},onLoad:function(t){this.java110Context.onLoad(),this.taskId=t.taskId,this.planName=t.planName,this.communityId=(0,i.getCurrentCommunity)().communityId;var n=this.java110Context.getUserInfo();this.userName=n.userName,this.userId=n.userId},onShow:function(){this._queryTaskDetail()},methods:{_queryTaskDetail:function(){var t=this;(0,s.queryMaintainanceTaskDetail)(this,{communityId:t.communityId,page:1,row:100,taskId:t.taskId}).then((function(n){t.taskDetails=n}))},ScrollSteps:function(){this.scroll=9==this.scroll?0:this.scroll+1},_excuteMaintaainance:function(t){uni.navigateTo({url:"/pages/maintainance/excuteOneMaintainance?taskDetailId="+t.taskDetailId+"&taskId="+t.taskId+"&machineId="+t.machineId+"&machineName="+t.machineName+"&standardId="+t.standardId})},preview:function(t,n){var a=[];this.taskDetails.forEach((function(n,e){e==t&&n.photos.forEach((function(t){a.push(t.url)}))})),uni.previewImage({urls:a,current:n})}}};n.default=o}}]);