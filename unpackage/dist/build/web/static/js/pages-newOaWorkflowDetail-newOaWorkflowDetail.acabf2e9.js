(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-newOaWorkflowDetail-newOaWorkflowDetail"],{"0f6b":function(t,e,o){"use strict";o.r(e);var n=o("c1cf"),a=o("71ca");for(var i in a)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return a[t]}))}(i);o("29bf");var r=o("828b"),s=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"71ee5284",null,!1,n["a"],void 0);e["default"]=s.exports},"29bf":function(t,e,o){"use strict";var n=o("dec4"),a=o.n(n);a.a},"5d1a":function(t,e,o){"use strict";o("6a54");var n=o("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.auditOaWorkflow=function(t,e){return new Promise((function(o,n){t.context.post({url:a.default.auditOaWorkflow,data:e,success:function(t){o(t)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.auditUndo=function(t,e,o){return new Promise((function(n,a){t.context.post({url:e,data:o,success:function(t){n(t)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.getNextTask=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.getNextTask,data:e,success:function(t){0==t.data.code?o(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.listRunWorkflowImage=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.listRunWorkflowImage,data:e,success:function(t){0==t.data.code?o(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryNextDealUser=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.queryNextDealUser,data:e,success:function(t){if(0!=t.data.code)n("未包含数据");else{var e=t.data.data;o(e)}},fail:function(t){n(t)}})}))},e.queryOaWorkflow=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.queryOaWorkflow,data:e,success:function(t){0==t.data.code?o(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryOaWorkflowForm=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.queryOaWorkflowForm,data:e,success:function(t){0==t.data.code?o(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryOaWorkflowFormData=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.queryOaWorkflowFormData,data:e,success:function(t){0==t.data.code?o(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryOaWorkflowUser=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.queryOaWorkflowUser,data:e,success:function(t){0==t.data.code?o(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryOaWorkflowUserHisTaskFormData=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.queryOaWorkflowUserHisTaskFormData,data:e,success:function(t){0==t.data.code?o(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.queryOaWorkflowUserTaskFormData=function(t,e){return new Promise((function(o,n){t.context.get({url:a.default.queryOaWorkflowUserTaskFormData,data:e,success:function(t){0==t.data.code?o(t.data):wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.saveOaWorkflowFormData=function(t,e){return new Promise((function(o,n){t.context.post({url:a.default.saveOaWorkflowFormData,data:e,success:function(t){o(t)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},e.updateOaWorkflowFormData=function(t,e){return new Promise((function(o,n){t.context.post({url:a.default.updateOaWorkflowFormData,data:e,success:function(t){o(t)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},o("bf0f");var a=n(o("f3d1"))},"626d":function(t,e,o){"use strict";o("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o("5d1a"),a=o("ce6d"),i={data:function(){return{oaWorkflowData:{},id:"",flowId:"",components:[],comments:[],flowImage:"",action:"",taskId:""}},onLoad:function(t){this.java110Context.onLoad(),this.id=t.id,this.flowId=t.flowId,this.action=t.action,this.taskId=t.taskId,this._loadOaWorkflowForm(),this._loadOaWorkflowDetail(),this._queryOaWorkflowUser(),this._listRunWorkflowImage()},methods:{_loadOaWorkflowForm:function(){var t=this;(0,n.queryOaWorkflowForm)(this,{page:1,row:10,flowId:this.flowId}).then((function(e){t.formJson=JSON.parse(e.data[0].formJson),t.components=t.formJson.components}))},isMe:function(){var t=(0,a.getUserInfo)().userId;return!(this.oaWorkflowData.create_user_id!=t||!this.action)},_loadOaWorkflowDetail:function(){var t=this;(0,n.queryOaWorkflowFormData)(this,{page:1,row:1,flowId:this.flowId,id:this.id}).then((function(e){t.oaWorkflowData=e.data[0]}))},_queryOaWorkflowUser:function(){var t=this;(0,n.queryOaWorkflowUser)(this,{page:1,row:100,flowId:this.flowId,id:this.id}).then((function(e){t.comments=e.data}))},_listRunWorkflowImage:function(){var t=this;(0,n.listRunWorkflowImage)(this,{communityId:"",businessKey:this.id}).then((function(e){t.flowImage="data:image/png;base64,"+e.data}))},doDealOaWorkflow:function(){this.context.navigateTo({url:"/pages/newOaWorkflowUndoAudit/newOaWorkflowUndoAudit?flowId="+this.flowId+"&id="+this.id+"&taskId="+this.taskId})},doEditOaWorkflow:function(){this.context.navigateTo({url:"/pages/newOaWorkflowFormEdit/newOaWorkflowFormEdit?flowId="+this.flowId+"&id="+this.id})},_getNewOaWorkflowDetailState:function(t){if(!t.hasOwnProperty("state"))return this.$t("未知");switch(t.state){case"1001":return this.$t("申请");case"1002":return this.$t("待审核");case"1003":return this.$t("退回");case"1004":return this.$t("委托");case"1005":return this.$t("办结")}return this.$t("未知")},downLoadOaWorkflowFile:function(){var t=document.createElement("a");document.body.appendChild(t),t.href=this.oaWorkflowData.files[0].realFileName,t.target="_blank",t.click(),document.body.removeChild(t)}}};e.default=i},"67d9":function(t,e,o){var n=o("c86c");e=n(!1),e.push([t.i,".solid-bottom[data-v-71ee5284]::after{border-bottom:%?2?% solid rgba(0,0,0,.1)}",""]),t.exports=e},"71ca":function(t,e,o){"use strict";o.r(e);var n=o("626d"),a=o.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(i);e["default"]=a.a},c1cf:function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",[o("v-uni-view",{staticClass:"bg-white margin-top margin-right-xs radius margin-left-xs padding"},[o("v-uni-view",{staticClass:"flex padding-bottom-xs solid-bottom justify-between"},[o("v-uni-view",[t._v(t._s(t.oaWorkflowData.create_user_name))]),o("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.oaWorkflowData.create_time))])],1),o("v-uni-view",{staticClass:"flex margin-top justify-between"},[o("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.$t("工单状态")))]),o("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t._getNewOaWorkflowDetailState(t.oaWorkflowData)))])],1),t._l(t.components,(function(e,n){return["text"!=e.type&&"button"!=e.type?o("v-uni-view",{key:n,staticClass:"flex margin-top-xs justify-between"},[o("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(e.label))]),o("v-uni-view",{staticClass:"text-gray"},[t._v(t._s(t.oaWorkflowData[e.key]))])],1):t._e()]})),o("v-uni-view",{staticClass:"solid-top flex justify-end margin-top padding-top-sm "},[t.isMe()?o("v-uni-button",{staticClass:"cu-btn sm bg-orange margin-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doEditOaWorkflow()}}},[t._v(t._s(t.$t("编辑")))]):t._e(),"Audit"==t.action?o("v-uni-button",{staticClass:"cu-btn sm bg-green margin-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doDealOaWorkflow()}}},[t._v(t._s(t.$t("处理")))]):t._e(),t.oaWorkflowData.files&&t.oaWorkflowData.files.length>0?o("a",{staticClass:"table-btn",attrs:{href:t.oaWorkflowData.files[0].realFileName,target:"_blank"}},[t._v(t._s(t.$t("下载")))]):t._e()],1)],2),o("v-uni-view",{staticClass:"cu-timeline bg-white margin-top margin-right-xs radius margin-left-xs padding"},[o("v-uni-view",{staticClass:"cu-time"},[t._v(t._s(t.$t("工单")))]),t._l(t.comments,(function(e,n){return o("v-uni-view",{key:n,staticClass:"cu-item "},[o("v-uni-view",{staticClass:"bg-cyan content"},[o("v-uni-text",[t._v(t._s(e.startTime))]),t._v(t._s(t.$t("到达"))+" "+t._s(e.staffName)+" "+t._s(t.$t("工位")))],1),void 0!=e.endTime?o("v-uni-view",{staticClass:"bg-cyan content"},[o("v-uni-text",[t._v(t._s(e.endTime))]),t._v(t._s(t.$t("处理完成")))],1):t._e(),void 0!=e.endTime?o("v-uni-view",{staticClass:"bg-cyan content"},[o("v-uni-text",[t._v(t._s(t.$t("处理意见"))+"：")]),t._v(t._s(e.context))],1):t._e()],1)}))],2),o("v-uni-view",{staticClass:"cu-timeline bg-white margin-top margin-right-xs radius margin-left-xs padding"},[o("v-uni-view",{staticClass:"cu-time"},[t._v(t._s(t.$t("流程图")))]),o("v-uni-view",{},[o("v-uni-image",{attrs:{src:t.flowImage,"data-url":t.flowImage,mode:"widthFix"}})],1)],1)],1)},a=[]},dec4:function(t,e,o){var n=o("67d9");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=o("967d").default;a("6f8484e4",n,!0,{sourceMap:!1,shadowMode:!1})}}]);