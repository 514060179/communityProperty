(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repairHandle-repairHandle"],{"0727":function(e,t,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("aa9c"),a("bf0f"),a("2797"),a("c223"),a("e838"),a("dd2b");var n=a("bf30"),o=a("cc44"),r=i(a("9b8e")),s=a("dae2"),u=i(a("3d9b"));r.default.prototype.$preventClick=o.preventClick;var c={data:function(){var e=this,t=function(t){return e.$t(t)};return{onoff:!0,staffCloums:[{staffName:t("please_select_employee")}],action:"",repairId:"",publicArea:"",repairType:"",repairChannel:"",imgList:[],photos:[],beforeRepairImgList:[],afterRepairImgList:[],beforeRepairPhotos:[],afterRepairPhotos:[],repairStaffIndex:0,staffId:"",staffName:"",content:"",userId:"",userName:"",feeFlag:"",amount:0,feeCloums:[{id:"",name:t("please_select")}],feeIndex:0,repairObjType:"",storeId:"",resourceStoreInfo:[],payTypes:[{statusCd:"",name:t("please_select")}],payTypeIndex:0,payType:"",communityId:"",uploadImageBefore:{maxPhotoNum:4,imgTitle:t("upload_before_maintenance_image"),canEdit:!0},uploadImageAfter:{maxPhotoNum:4,imgTitle:t("upload_after_maintenance_image"),canEdit:!0}}},components:{uploadImageAsync:u.default},onLoad:function(e){var t=this;this.communityId=(0,s.getCurrentCommunity)().communityId,this.java110Context.onLoad(),this.publicArea=e.publicArea,this.action=e.action,this.repairId=e.repairId,this.repairType=e.repairType,this.repairObjType=e.repairObjType,this.repairChannel=e.repairChannel;var a=this.java110Context.getUserInfo();this.userId=a.userId,this.storeId=a.storeId,this.userName=a.userName,"BACK"==this.action&&(this.staffId=e.preStaffId,this.staffName=e.preStaffName),"004"==this.repairObjType?this.feeCloums.push({id:"1001",name:t.$t("paid_service")},{id:"1002",name:t.$t("free_service")}):this.feeCloums.push({id:"1003",name:t.$t("need_materials")},{id:"1004",name:t.$t("no_need_materials")}),this._loadRepairStaff(),this._loadPayTypes(),uni.$on("getResourceInfo",(function(e){console.log(e),t._getResourceInfo(e)}))},onUnload:function(){uni.$off("getResourceInfo")},methods:{sendImagesDataBefore:function(e){var t=this;console.log("before",e),this.beforeRepairPhotos=[],e.length>0&&e.forEach((function(e){t.beforeRepairPhotos.push(e.fileId)}))},sendImagesDataAfter:function(e){var t=this;console.log("after",e),this.afterRepairPhotos=[],e.length>0&&e.forEach((function(e){t.afterRepairPhotos.push(e.fileId)}))},_loadPayTypes:function(){var e=this;(0,n.queryDictInfo)(this,{name:"r_repair_pool",type:"pay_type"}).then((function(t){e.payTypes=e.payTypes.concat(t)}))},payTypeChange:function(e){if(this.payTypeIndex=e.target.value,0!=this.payTypeIndex){var t=this.payTypes[this.payTypeIndex];this.payType=t.statusCd}else this.payType=""},_getResourceInfo:function(e){e=JSON.parse(e),this.resourceStoreInfo.push(e),this._updateTotalPrice()},userNumberChange:function(e,t){if("inc"==t)this.resourceStoreInfo[e].useNumber=parseFloat(this.resourceStoreInfo[e].useNumber)+1;else{if(this.resourceStoreInfo[e].useNumber<=1)return void uni.showToast({title:this.$t("cannot_reduce_further"),icon:"none"});this.resourceStoreInfo[e].useNumber-=1}this._updateTotalPrice()},_updateTotalPrice:function(){var e=this;this.amount=0,this.resourceStoreInfo.forEach((function(t){var a=parseFloat(t.useNumber),i=parseFloat(t.price);isNaN(a)||isNaN(i)||(e.amount+=a*i)}))},_removeResourceItem:function(e){this.resourceStoreInfo.splice(e,1),this._updateTotalPrice()},_openSelectResourceModel:function(){uni.navigateTo({url:"/pages/repairHandle/selectResource?feeFlag="+this.feeFlag})},_loadRepairStaff:function(){var e=this,t={repairType:this.repairType,communtiyId:(0,s.getCurrentCommunity)().communityId,page:1,row:50,state:"9999"};(0,n.loadRepairStaff)(this,t).then((function(t){var a=t.data;if(0==a.code){var i=a.data;e.staffCloums=e.staffCloums.concat(i)}else uni.showToast({icon:"none",title:a.msg})}))},staffChange:function(e){if(this.repairStaffIndex=e.target.value,0==this.repairStaffIndex)return this.staffId="",void(this.staffName="");var t=this.staffCloums[this.repairStaffIndex];this.staffId=t.staffId,this.staffName=t.staffName},feeChange:function(e){if(this.feeIndex=e.target.value,0!=this.feeIndex){var t=this.feeCloums[this.feeIndex];this.feeFlag=t.id}else this.feeFlag=""},_dispatchRepair:function(e){var t=this;(0,n.dispatchRepair)(this).then((function(e){var a=e.data;if(0==a.code)return"DISPATCH"==t.action?void uni.navigateTo({url:"/pages/repairOrder/repairOrder"}):void uni.navigateTo({url:"/pages/repairDispatch/repairDispatch"});wx.showToast({title:a.msg,icon:"none",duration:2e3})}))},_finishRepair:function(){uni.showLoading({title:this.$t("chulizhong")}),(0,n.finishRepair)(this).then((function(e){var t=e.data;0!=t.code?uni.showToast({title:t.msg,icon:"none",duration:2e3}):uni.navigateTo({url:"/pages/repairDispatch/repairDispatch"})})),uni.hideLoading()}}};t.default=c},"10c4":function(e,t,a){"use strict";function i(e,t){var a=new Image;a.src=e,a.onload=function(){var e=this.height,a=this.width,i=document.createElement("canvas"),n=i.getContext("2d"),o=document.createAttribute("width");o.nodeValue=a;var r=document.createAttribute("height");r.nodeValue=e,i.setAttributeNode(o),i.setAttributeNode(r),n.drawImage(this,0,0,a,e);var s=i.toDataURL("image/jpeg",.3);i=null,t(s)}}a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.base64ToBlob=function(e){var t=e.split(","),a=t[0].match(/:(.*?);/)[1],i=atob(t[1]),n=i.length,o=new Uint8Array(n);while(n--)o[n]=i.charCodeAt(n);return new Blob([o],{type:a})},t.translate=function(e,t){i(e,t)},t.translateH5=i,a("5c47"),a("2c10"),a("c9b5"),a("15d1"),a("d5c6"),a("5a56"),a("f074"),a("4db2"),a("bf0f"),a("c976"),a("4d8f"),a("7b97"),a("668a"),a("c5b7"),a("8ff5"),a("2378"),a("641a"),a("64e0"),a("cce3"),a("efba"),a("d009"),a("bd7d"),a("7edd"),a("d798"),a("f547"),a("5e54"),a("b60a"),a("8c18"),a("12973"),a("f991"),a("198e"),a("8557"),a("63b1"),a("1954"),a("1cf1")},"37c9":function(e,t,a){"use strict";a("6a54");var i=a("f5bd").default,n=a("3639").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("64aa"),a("bf0f"),a("2797"),a("5ef2"),a("aa9c"),a("dd2b");var o=n(a("10c4")),r=i(a("91c2")),s=a("a4e1"),u=a("8196"),c=(u.factory,{name:"vc-upload",data:function(){return{photos:[],imgList:[],photoUrl:r.default.commonBaseUrl+"/callComponent/download/getFile/file",sendImgList:[]}},props:{communityId:{type:String,default:""},title:{type:String,default:"image_upload"},maxPhotoNum:{type:Number,default:1},count:{type:Number,default:1},sizeType:{type:Array,default:function(){return["original","compressed"]}},sourceType:{type:Array,default:function(){return["album","camera"]}},canEdit:{type:Boolean,default:!0}},watch:{photos:function(e){this.sendData()},deep:!0},mounted:function(){this._initImageList(this.sendImgList)},methods:{_initImageList:function(e){var t=this;this.sendImgList=e,this.sendImgList.forEach((function(e,a){if(e.indexOf("base64,")>-1&&t.imgList.push(_photo),e.indexOf("https")>-1||e.indexOf("http")>-1||e.indexOf(t.photoUrl)>-1){t.imgList.push(e);var i=t._getUrlParams(e);i["fileId"]&&t.photos.push({fileId:i["fileId"],url:e})}else{var n=t.photoUrl+"?fileId="+e+"&communityId=-1&time="+new Date;t.imgList.push(n),t.photos.push({fileId:e,url:n})}})),console.log(this.imgList)},sendData:function(){this.$emit("sendImagesData",this.photos)},_getUrlParams:function(e){if(e.indexOf("?")<0)return{fileId:e.substring(e.indexOf("img"))};for(var t=e.split("?")[1],a={},i=t.split("&"),n=0,o=i.length;n<o;n++){var r=i[n].split("=");a[r[0]]=r[1]}return a},deleteImage:function(e){this.imgList.splice(e,1),this.photos.splice(e,1)},ChooseImage:function(){var e=this;wx.chooseImage({count:this.count,sizeType:this.sizeType,sourceType:this.sourceType,success:function(t){var a=t.tempFilePaths[0];e.imgList.push(a),e.$forceUpdate(),o.translate(a,(function(t){var a={uploadFile:t,communityId:e.communityId};(0,s.uploadImageAsync)(a,e).then((function(t){e.photos.push(t)}))}))}})},preview:function(e){var t=this.imgList;t.length<1||(t.forEach((function(e,a){var i=e.indexOf("/callComponent");0==i&&(t[a]=r.default.commonBaseUrl+e)})),uni.previewImage({current:e,urls:t}))}}});t.default=c},"3a4e":function(e,t,a){var i=a("c86c");t=i(!1),t.push([e.i,".use-num-container[data-v-09ee7f7f]{display:flex;flex-direction:row}.use-num-input[data-v-09ee7f7f]{width:%?100?%;text-align:center;padding:0}.inc[data-v-09ee7f7f],\n.dec[data-v-09ee7f7f]{border:1px solid #000;border-radius:50%;width:%?40?%;height:%?40?%;text-align:center;line-height:%?40?%}.row[data-v-09ee7f7f]{width:95%;margin:0 auto;height:%?60?%;line-height:%?60?%;display:flex;flex-direction:row;justify-content:space-between}.item-t[data-v-09ee7f7f]{display:inline-block;text-align:center}.inline-input[data-v-09ee7f7f]{display:inline-block;width:%?100?%;vertical-align:middle;border-radius:%?15?%}.t-remove[data-v-09ee7f7f]{color:#0081ff;text-decoration:underline}",""]),e.exports=t},"3c5a":function(e,t,a){"use strict";a.r(t);var i=a("0727"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);t["default"]=n.a},"3d9b":function(e,t,a){"use strict";a.r(t);var i=a("9f50"),n=a("d849");for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);var r=a("828b"),s=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"527ee613",null,!1,i["a"],void 0);t["default"]=s.exports},4619:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",["FINISH"!=e.action?a("v-uni-view",["BACK"==e.action?a("v-uni-view",{staticClass:"cu-form-group margin-top"},[a("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("maintenance_staff")))]),a("v-uni-input",{attrs:{disabled:"disabled",placeholder:e.$t("please_enter_repairer")},model:{value:e.staffName,callback:function(t){e.staffName=t},expression:"staffName"}})],1):a("v-uni-view",{staticClass:"cu-form-group margin-top"},[a("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("maintenance_staff")))]),a("v-uni-picker",{attrs:{value:e.repairStaffIndex,range:e.staffCloums,"range-key":"staffName"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.staffChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.staffCloums[e.repairStaffIndex].staffName))])],1)],1)],1):a("v-uni-view",["004"!=e.repairObjType?a("v-uni-view",{staticClass:"cu-form-group margin-top"},[a("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("need_materials")))]),a("v-uni-picker",{attrs:{value:e.feeIndex,range:e.feeCloums,"range-key":"name"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.feeChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.feeCloums[e.feeIndex].name))])],1)],1):e._e(),"004"==e.repairObjType?a("v-uni-view",{staticClass:"cu-form-group margin-top"},[a("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("maintenance_type")))]),a("v-uni-picker",{attrs:{value:e.feeIndex,range:e.feeCloums,"range-key":"name"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.feeChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.feeCloums[e.feeIndex].name))])],1)],1):e._e(),"1001"==e.feeFlag||"1003"==e.feeFlag?a("v-uni-view",{staticClass:"flex flex-direction margin-top"},[a("v-uni-button",{staticClass:"cu-btn bg-blue margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._openSelectResourceModel()}}},[e._v(e._s(e.$t("select_product")))])],1):e._e(),("1001"==e.feeFlag||"1003"==e.feeFlag)&&e.resourceStoreInfo.length>0?a("v-uni-view",[a("v-uni-view",{staticClass:"row"},[a("v-uni-view",{staticClass:"item-t text-bold"},[e._v(e._s(e.$t("product")))]),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1001"==e.feeFlag,expression:"feeFlag=='1001'"}],staticClass:"item-t text-bold"},[e._v(e._s(e.$t("price"))+"MOP")]),a("v-uni-view",{staticClass:"item-t text-bold"},[e._v(e._s(e.$t("quantity")))]),a("v-uni-view",{staticClass:"item-t text-bold"},[e._v(e._s(e.$t("operation")))])],1),e._l(e.resourceStoreInfo,(function(t,i){return a("v-uni-view",{staticClass:"resource-item text-grey"},[a("v-uni-view",{staticClass:"row"},[t.isCustom?a("v-uni-view",{staticClass:"item-t"},[e._v(e._s(t.customGoodsName))]):a("v-uni-view",{staticClass:"item-t"},[e._v(e._s(t.resName)+"("+e._s(t.specName?t.specName:"-")+")")]),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1001"==e.feeFlag,expression:"feeFlag=='1001'"}],staticClass:"item-t"},[a("v-uni-input",{staticClass:"inline-input text-grey bg-white",attrs:{type:"number",disabled:!t.isCustom&&t.outHighPrice==t.outLowPrice},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e._updateTotalPrice()}},model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}})],1),a("v-uni-view",{staticClass:"item-t"},[a("v-uni-text",{staticClass:"cuIcon-move text-black padding-right-sm padding-left-sm",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.userNumberChange(i,"dec")}}}),a("v-uni-input",{staticClass:"inline-input text-grey bg-white",attrs:{type:"number"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e._updateTotalPrice()}},model:{value:t.useNumber,callback:function(a){e.$set(t,"useNumber",a)},expression:"item.useNumber"}}),a("v-uni-text",{staticClass:"cuIcon-add text-black padding-right-sm padding-left-sm",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.userNumberChange(i,"inc")}}})],1),a("v-uni-view",{staticClass:"item-t"},[a("v-uni-text",{staticClass:"t-remove",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._removeResourceItem(i)}}},[e._v(e._s(e.$t("remove")))])],1)],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1001"==e.feeFlag&&!t.isCustom&&t.outHighPrice!=t.outLowPrice,expression:"feeFlag == '1001' && !item.isCustom && item.outHighPrice != item.outLowPrice"}],staticClass:"row"},[e._v(e._s(e.$t("price_range"))+"("+e._s(t.outLowPrice)+" - "+e._s(t.outHighPrice)+")")])],1)}))],2):e._e(),"1001"==e.feeFlag?a("v-uni-view",{staticClass:"cu-form-group margin-top"},[a("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("total"))+"MOP")]),a("v-uni-input",{attrs:{disabled:"disabled"},model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}})],1):e._e()],1),"1001"==e.feeFlag?a("v-uni-view",{staticClass:"cu-form-group margin-top"},[a("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("payment_method")))]),a("v-uni-picker",{attrs:{value:e.payTypeIndex,range:e.payTypes,"range-key":"name"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.payTypeChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.payTypes[e.payTypeIndex].name))])],1)],1):e._e(),a("v-uni-view",{staticClass:"cu-form-group margin-top"},[a("v-uni-textarea",{attrs:{placeholder:e.$t("please_enter_handling_comments")},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),"FINISH"==e.action?a("v-uni-view",[a("uploadImageAsync",{ref:"vcUploadRef",staticStyle:{"margin-top":"30upx"},attrs:{communityId:e.communityId,maxPhotoNum:e.uploadImageBefore.maxPhotoNum,canEdit:e.uploadImageBefore.canEdit,title:e.uploadImageBefore.imgTitle},on:{sendImagesData:function(t){arguments[0]=t=e.$handleEvent(t),e.sendImagesDataBefore.apply(void 0,arguments)}}}),a("uploadImageAsync",{ref:"vcUploadRef",staticStyle:{"margin-top":"30upx"},attrs:{communityId:e.communityId,maxPhotoNum:e.uploadImageAfter.maxPhotoNum,canEdit:e.uploadImageAfter.canEdit,title:e.uploadImageAfter.imgTitle},on:{sendImagesData:function(t){arguments[0]=t=e.$handleEvent(t),e.sendImagesDataAfter.apply(void 0,arguments)}}})],1):a("v-uni-view"),"FINISH"==e.action?a("v-uni-view",{staticClass:"flex flex-direction margin-top"},[a("v-uni-button",{staticClass:"cu-btn bg-green margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$preventClick(e._finishRepair)}}},[e._v(e._s(e.$t("complete")))])],1):a("v-uni-view",{staticClass:"flex flex-direction margin-top"},[a("v-uni-button",{staticClass:"cu-btn bg-green margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._dispatchRepair()}}},[e._v("提交")])],1)],1)},n=[]},"6aef":function(e,t,a){"use strict";var i=a("cac9"),n=a.n(i);n.a},"9f50":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("v-uni-view",{staticClass:"cu-bar bg-white "},[a("v-uni-view",{staticClass:"action"},[e._v(e._s(e.title))]),e.canEdit?a("v-uni-view",{staticClass:"action"},[e._v(e._s(e.imgList.length)+"/"+e._s(e.maxPhotoNum))]):e._e()],1),a("v-uni-view",{staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[e._l(e.imgList,(function(t,i){return a("v-uni-view",{staticClass:"bg-img",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.preview(i)}}},[a("v-uni-image",{attrs:{src:t,mode:"aspectFill"}}),e.canEdit?a("v-uni-view",{staticClass:"cu-tag bg-red",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.deleteImage(i)}}},[a("v-uni-text",{staticClass:"cuIcon-close"})],1):e._e()],1)})),e.canEdit&&e.imgList.length<e.maxPhotoNum?a("v-uni-view",{staticClass:"solids",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ChooseImage.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):e._e()],2)],1)],1)},n=[]},a4e1:function(e,t,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.queryOrgInfo=function(e,t){return new Promise((function(a,i){e.context.get({url:n.default.queryOrgInfo,data:t,success:function(e){a(e)},fail:function(e){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},t.queryStaffListInfo=function(e,t){return new Promise((function(a,i){e.context.get({url:n.default.queryStaffListInfo,data:t,success:function(e){a(e)},fail:function(e){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}})}))},t.uploadImageAsync=function(e,t){return new Promise((function(a,i){t.context.post({url:n.default.uploadImage,data:e,success:function(e){if(200==e.statusCode){var t=e.data;a(t)}},fail:function(e){uni.hideLoading(),uni.showToast({title:i18n.t("server_error"),icon:"none"})}})}))},a("bf0f");var n=i(a("f3d1"))},bf30:function(e,t,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.appraiseRepair=function(e){return new Promise((function(t,a){if(""!=e.remark)if(""!=e.repairId){var i={repairId:e.repairId,repairType:e.repairType,repairChannel:e.repairChannel,publicArea:e.publicArea,communityId:e.communityId,context:e.remark};e.context.post({url:n.default.appraiseRepairNew,data:i,success:function(e){t(e)},fail:function(e){wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}})}else uni.showToast({title:r.default.t("wbhbxxxx"),icon:"none"});else uni.showToast({title:r.default.t("qtxpjnrs"),icon:"none"})}))},t.dispatchRepair=function(e){return new Promise((function(t,a){var i={staffId:e.staffId,staffName:e.staffName,context:e.content,repairId:e.repairId,repairType:e.repairType,action:e.action,communityId:(0,o.getCurrentCommunity)().communityId,photos:[],userId:e.userId,userName:e.userName},s=e.photos;s.forEach((function(e){i.photos.push({photo:e})}));var u="";""==i.context?u=r.default.t("please_enter_handling_comments"):""==i.staffId||""==i.staffName?u=r.default.t("qtxsf1"):""==i.repairId?u=r.default.t("errorData"):"TRANSFER"==i.action&&i.userId==i.staffId&&(u=r.default.t("bnzdgzj")),""==u?e.context.post({url:n.default.repairDispatch,data:i,success:function(e){t(e)},fail:function(e){wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}}):wx.showToast({title:u,icon:"none",duration:2e3})}))},t.finishRepair=function(e){return new Promise((function(t,a){var i={feeFlag:e.feeFlag,context:e.content,repairId:e.repairId,repairChannel:e.repairChannel,publicArea:e.publicArea,maintenanceType:e.feeFlag,repairType:e.repairType,action:e.action,communityId:(0,o.getCurrentCommunity)().communityId,beforeRepairPhotos:[],afterRepairPhotos:[],repairObjType:e.repairObjType,userId:e.userId,userName:e.userName,storeId:e.storeId,choosedGoodsList:e.resourceStoreInfo,totalPrice:e.amount,payType:e.payType},s=e.beforeRepairPhotos;s.forEach((function(e){i.beforeRepairPhotos.push({photo:e})}));var u=e.afterRepairPhotos;u.forEach((function(e){i.afterRepairPhotos.push({photo:e})}));var c="";if(i.feeFlag?""==i.context?c=r.default.t("please_enter_handling_comments"):i.beforeRepairPhotos.length<=0||i.afterRepairPhotos.length<=0?c=r.default.t("qsctptt"):""==i.repairId?c=r.default.t("errorData"):("1001"==i.maintenanceType||"1003"==i.maintenanceType)&&i.choosedGoodsList.length<1?c=r.default.t("qxzwppp"):"1001"==i.maintenanceType&&""==i.payType?c=r.default.t("qxzzffssss"):("1001"==i.maintenanceType||"1003"==i.maintenanceType)&&i.choosedGoodsList.length>=1&&i.choosedGoodsList.forEach((function(e){(!e.useNumber||e.useNumber<1)&&(c=r.default.t("spslywww")),"1001"==i.maintenanceType&&(!e.price||e.price<0)&&(c=r.default.t("spjgywww"))})):c=r.default.t("qxzlxx"),""!=c)return wx.showToast({title:c,icon:"none",duration:2e3}),void(e.onoff=!0);"1002"!=i.maintenanceType&&"1004"!=i.maintenanceType||(i.useNumber=0,i.choosedGoodsList=[]),e.context.post({url:n.default.repairFinish,data:i,success:function(a){e.onoff=!0,t(a)},fail:function(t){e.onoff=!0,wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}})}))},t.loadRepairStaff=function(e,t){return new Promise((function(a,i){e.context.get({url:n.default.listRepairTypeUsers,data:t,success:function(e){a(e)},fail:function(e){wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}})}))},t.queryDictInfo=function(e,t){return new Promise((function(a,i){e.context.get({url:n.default.queryDictInfo,data:t,success:function(e){a(e.data)},fail:function(e){wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}})}))},t.queryRepairInfo=function(e,t){return new Promise((function(a,i){e.context.get({url:n.default.queryRepairInfo,data:t,success:function(e){a(e.data)},fail:function(e){wx.showToast({title:"",icon:"none",duration:2e3})}})}))},t.queryResourceStoreResName=function(e,t){return new Promise((function(a,i){e.context.get({url:n.default.queryResourceStoreResName,data:t,success:function(e){a(e)},fail:function(e){wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}})}))},t.repairStart=function(e,t){return new Promise((function(a,i){e.context.post({url:n.default.repairStart,data:t,success:function(e){a(e.data)},fail:function(e){wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}})}))},t.repairStop=function(e,t){return new Promise((function(a,i){e.context.post({url:n.default.repairStop,data:t,success:function(e){a(e.data)},fail:function(e){wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}})}))},t.replyRepairAppraise=function(e,t){return new Promise((function(a,i){t.context.post({url:n.default.replyRepairAppraise,data:e,success:function(e){a(e.data)},fail:function(e){wx.showToast({title:r.default.t("server_error"),icon:"none",duration:2e3})}})}))},a("bf0f"),a("2797"),a("aa9c");var n=i(a("f3d1")),o=a("dae2"),r=i(a("479f"))},cac9:function(e,t,a){var i=a("3a4e");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("967d").default;n("155ebfa5",i,!0,{sourceMap:!1,shadowMode:!1})},cc44:function(e,t,a){"use strict";a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.getFileType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("."),a=t[t.length-1];if(!a)return"";a=a.toLocaleLowerCase();var i=["png","jpg","jpeg","bmp","gif","webp"];if(i.includes(a))return"image";var n=["mp4","m4v"];if(n.includes(a))return"video";var o=["mp3","m4a","wav","aac"];if(o.includes(a))return"audio";var r=["pdf","doc","docx","xls","xlsx","ppt","pptx","txt","plain"];return r.includes(a)?"office":"unknown"},t.preventClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=this;a.onoff?(a.onoff=!1,e(t)):uni.showToast({title:"操作过于频繁",icon:"none"})},a("4626")},d849:function(e,t,a){"use strict";a.r(t);var i=a("37c9"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(o);t["default"]=n.a},dd96:function(e,t,a){"use strict";a.r(t);var i=a("4619"),n=a("3c5a");for(var o in n)["default"].indexOf(o)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(o);a("6aef");var r=a("828b"),s=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"09ee7f7f",null,!1,i["a"],void 0);t["default"]=s.exports}}]);