(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repairHandle-selectResource"],{"0034":function(e,t,o){var s=o("c86c");t=s(!1),t.push([e.i,".select-single-resource[data-v-268d4b6c]{position:fixed;top:%?100?%;left:0;background-color:#fff;width:100%;height:100%}.use-num-container[data-v-268d4b6c]{display:flex;flex-direction:row}.use-num-input[data-v-268d4b6c]{width:%?100?%;text-align:center;padding:0}.inc[data-v-268d4b6c],\n.dec[data-v-268d4b6c]{border:1px solid #000;border-radius:50%;width:%?40?%;height:%?40?%;text-align:center;line-height:%?40?%}",""]),e.exports=t},"214ed":function(e,t,o){"use strict";o.d(t,"b",(function(){return s})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){}));var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",[o("v-uni-view",{staticClass:"cu-bar bg-white "},[o("v-uni-view",{staticClass:"action"},[o("v-uni-text",{staticClass:"cuIcon-title text-orange "}),e._v(e._s(e.$t("choose_item")))],1),o("v-uni-view",{staticClass:"action"})],1),o("v-uni-view",{staticClass:"select-single-resource"},[o("v-uni-view",[o("v-uni-view",{staticClass:"cu-form-group margin-top"},[o("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("item_type")))]),o("v-uni-picker",{attrs:{value:e.goodsTypeIndex,range:e.goodsTypeCloums,"range-key":"name"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.goodsParentTypeChange.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.goodsTypeCloums[e.goodsTypeIndex].name))])],1)],1),e.isCustom?o("v-uni-view",[o("v-uni-view",{staticClass:"cu-form-group margin-top"},[o("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("item_name")))]),o("v-uni-input",{attrs:{placeholder:e.$t("enter_item_name")},model:{value:e.customGoodsName,callback:function(t){e.customGoodsName=t},expression:"customGoodsName"}})],1),o("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1001"==e.feeFlag,expression:"feeFlag == '1001'"}],staticClass:"cu-form-group margin-top"},[o("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("pricess")))]),o("v-uni-input",{attrs:{type:"number",placeholder:e.$t("please_pricess")},model:{value:e.singlePrice,callback:function(t){e.singlePrice=t},expression:"singlePrice"}})],1)],1):o("v-uni-view",[o("v-uni-view",{staticClass:"cu-form-group margin-top"},[o("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("secondary_category")))]),o("v-uni-picker",{attrs:{value:e.goodsSonTypeIndex,range:e.goodsSonTypeCloums,"range-key":"name"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.goodsTypeChange.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.goodsSonTypeCloums[e.goodsSonTypeIndex].name))])],1)],1),""!=e.rstId?o("v-uni-view",{staticClass:"cu-form-group margin-top"},[o("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("item")))]),o("v-uni-picker",{attrs:{value:e.goodsIndex,range:e.goodsCloums,"range-key":"resName"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.goodsChange.apply(void 0,arguments)}}},[o("v-uni-view",{staticClass:"picker"},[e._v(e._s(e.goodsCloums[e.goodsIndex].resName))])],1)],1):e._e(),0!=e.goodsIndex?o("v-uni-view",[o("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1001"==e.feeFlag,expression:"feeFlag == '1001'"}],staticClass:"cu-form-group margin-top"},[o("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("unit_price")))]),o("v-uni-input",{attrs:{type:"number",disabled:e.disabledPrice,placeholder:"$t('enter_unit_price')"},model:{value:e.singlePrice,callback:function(t){e.singlePrice=t},expression:"singlePrice"}})],1),o("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"1001"==e.feeFlag,expression:"feeFlag == '1001'"}]},[e.goods.outHighPrice==e.goods.outLowPrice?o("v-uni-view",{staticClass:"text-right text-grey"},[e._v(e._s(e.$t("price"))+":"+e._s(e.goods.outLowPrice))]):o("v-uni-view",{staticClass:"text-right text-grey"},[e._v(e._s(e.$t("price_range"))+e._s(e.goods.outLowPrice)+"-"+e._s(e.goods.outHighPrice))])],1),o("v-uni-view",{staticClass:"cu-form-group margin-top"},[o("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("specification")))]),o("v-uni-input",{attrs:{type:"text",disabled:"disabled"},model:{value:e.goods.specName,callback:function(t){e.$set(e.goods,"specName",t)},expression:"goods.specName"}})],1)],1):e._e()],1),o("v-uni-view",{staticClass:"cu-form-group margin-top"},[o("v-uni-view",{staticClass:"title"},[e._v(e._s(e.$t("quantity")))]),o("v-uni-view",{staticClass:"use-num-container"},[o("v-uni-view",{staticClass:"dec",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.numDec.apply(void 0,arguments)}}},[e._v("-")]),o("v-uni-input",{staticClass:"use-num-input",attrs:{disabled:"disabled"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.goodsNumChange.apply(void 0,arguments)}},model:{value:e.useNumber,callback:function(t){e.useNumber=t},expression:"useNumber"}}),o("v-uni-view",{staticClass:"inc",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.numInc.apply(void 0,arguments)}}},[e._v("+")])],1)],1),o("v-uni-view",{staticClass:"flex flex-direction margin-top"},[o("v-uni-button",{staticClass:"cu-btn bg-blue margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._save()}}},[e._v(e._s(e.$t("confirm")))])],1),o("v-uni-view",{staticClass:"flex flex-direction margin-top"},[o("v-uni-button",{staticClass:"cu-btn bg-red margin-tb-sm lg",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e._canel()}}},[e._v("取消")])],1)],1)],1)],1)},i=[]},3121:function(e,t,o){"use strict";o("6a54");var s=o("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.appraiseRepair=function(e,t){return new Promise((function(o,s){if(""!=e.remark)if(""!=e.repairId){var n={repairId:e.repairId,repairType:e.repairType,repairChannel:e.repairChannel,publicArea:e.publicArea,communityId:e.communityId,context:e.remark};e.context.post({url:i.default.appraiseRepairNew,data:n,success:function(e){o(e)},fail:function(e){wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},t)}else uni.showToast({title:a.default.t("wbhbxxxx"),icon:"none"});else uni.showToast({title:a.default.t("qtxpjnrs"),icon:"none"})}))},t.dispatchRepair=function(e,t){return new Promise((function(o,s){var r={staffId:e.staffId,staffName:e.staffName,context:e.content,repairId:e.repairId,repairType:e.repairType,action:e.action,communityId:(0,n.getCurrentCommunity)().communityId,photos:[],userId:e.userId,userName:e.userName},u=e.photos;u.forEach((function(e){r.photos.push({photo:e})}));var c="";""==r.context?c=a.default.t("please_enter_handling_comments"):""==r.staffId||""==r.staffName?c=a.default.t("qtxsf1"):""==r.repairId?c=a.default.t("errorData"):"TRANSFER"==r.action&&r.userId==r.staffId&&(c=a.default.t("bnzdgzj")),""==c?e.context.post({url:i.default.repairDispatch,data:r,success:function(e){o(e)},fail:function(e){wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},t):wx.showToast({title:c,icon:"none",duration:2e3})}))},t.finishRepair=function(e,t){return new Promise((function(o,s){var r={feeFlag:e.feeFlag,context:e.content,repairId:e.repairId,repairChannel:e.repairChannel,publicArea:e.publicArea,maintenanceType:e.feeFlag,repairType:e.repairType,action:e.action,communityId:(0,n.getCurrentCommunity)().communityId,beforeRepairPhotos:[],afterRepairPhotos:[],repairObjType:e.repairObjType,userId:e.userId,userName:e.userName,storeId:e.storeId,choosedGoodsList:e.resourceStoreInfo,totalPrice:e.amount,payType:e.payType},u=e.beforeRepairPhotos;u.forEach((function(e){r.beforeRepairPhotos.push({photo:e})}));var c=e.afterRepairPhotos;c.forEach((function(e){r.afterRepairPhotos.push({photo:e})}));var d="";if(r.feeFlag?""==r.context?d=a.default.t("please_enter_handling_comments"):r.beforeRepairPhotos.length<=0||r.afterRepairPhotos.length<=0?d=a.default.t("qsctptt"):""==r.repairId?d=a.default.t("errorData"):("1001"==r.maintenanceType||"1003"==r.maintenanceType)&&r.choosedGoodsList.length<1?d=a.default.t("qxzwppp"):"1001"==r.maintenanceType&&""==r.payType?d=a.default.t("qxzzffssss"):("1001"==r.maintenanceType||"1003"==r.maintenanceType)&&r.choosedGoodsList.length>=1&&r.choosedGoodsList.forEach((function(e){(!e.useNumber||e.useNumber<1)&&(d=a.default.t("spslywww")),"1001"==r.maintenanceType&&(!e.price||e.price<0)&&(d=a.default.t("spjgywww"))})):d=a.default.t("qxzlxx"),""!=d)return wx.showToast({title:d,icon:"none",duration:2e3}),void(e.onoff=!0);"1002"!=r.maintenanceType&&"1004"!=r.maintenanceType||(r.useNumber=0,r.choosedGoodsList=[]),e.context.post({url:i.default.repairFinish,data:r,success:function(t){e.onoff=!0,o(t)},fail:function(t){e.onoff=!0,wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},t)}))},t.loadRepairStaff=function(e,t,o){return new Promise((function(s,n){e.context.get({url:i.default.listRepairTypeUsers,data:t,success:function(e){s(e)},fail:function(e){wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},o)}))},t.queryDictInfo=function(e,t,o){return new Promise((function(s,n){e.context.get({url:i.default.queryDictInfo,data:t,success:function(e){s(e.data)},fail:function(e){wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},o)}))},t.queryRepairInfo=function(e,t,o){return new Promise((function(s,n){e.context.get({url:i.default.queryRepairInfo,data:t,success:function(e){s(e.data)},fail:function(e){wx.showToast({title:"",icon:"none",duration:2e3})}},o)}))},t.queryResourceStoreResName=function(e,t,o){return new Promise((function(s,n){e.context.get({url:i.default.queryResourceStoreResName,data:t,success:function(e){s(e)},fail:function(e){wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},o)}))},t.repairStart=function(e,t,o){return new Promise((function(s,n){e.context.post({url:i.default.repairStart,data:t,success:function(e){s(e.data)},fail:function(e){wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},o)}))},t.repairStop=function(e,t,o){return new Promise((function(s,n){e.context.post({url:i.default.repairStop,data:t,success:function(e){s(e.data)},fail:function(e){wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},o)}))},t.replyRepairAppraise=function(e,t,o){return new Promise((function(s,n){t.context.post({url:i.default.replyRepairAppraise,data:e,success:function(e){s(e.data)},fail:function(e){wx.showToast({title:a.default.t("server_error"),icon:"none",duration:2e3})}},o)}))},o("bf0f"),o("2797"),o("aa9c");var i=s(o("f0de")),n=o("2d9e"),a=s(o("3e79"))},"7aa6b":function(e,t,o){var s=o("0034");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var i=o("967d").default;i("6394d0f8",s,!0,{sourceMap:!1,shadowMode:!1})},"7d4a":function(e,t,o){"use strict";var s=o("7aa6b"),i=o.n(s);i.a},cbc4:function(e,t,o){"use strict";o.r(t);var s=o("e3a6"),i=o.n(s);for(var n in s)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return s[e]}))}(n);t["default"]=i.a},e1e0:function(e,t,o){"use strict";o.r(t);var s=o("214ed"),i=o("cbc4");for(var n in i)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(n);o("7d4a");var a=o("828b"),r=Object(a["a"])(i["default"],s["b"],s["c"],!1,null,"268d4b6c",null,!1,s["a"],void 0);t["default"]=r.exports},e3a6:function(e,t,o){"use strict";o("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,o("c223"),o("aa9c"),o("d4b5");var s=o("3121"),i=o("2d9e"),n={components:{},data:function(){var e=this,t=function(t){return e.$t(t)};return{showModel:!1,amount:"",singlePrice:"",useNumber:1,disabledPrice:!1,goodsTypeCloums:[{name:t("please_choose_item_type")}],goodsTypeIndex:0,parentRstId:"",goodsSonTypeCloums:[{name:t("please_choose_item_type")}],goodsSonTypeIndex:0,rstId:"",goodsCloums:[{resName:t("please_choose_item")}],goodsIndex:0,goods:{resId:"",outLowPrice:"",outHighPrice:""},isCustom:!1,customGoodsName:"",resourceStoreInfo:[],feeFlag:""}},onLoad:function(e){this.resetData(),this.feeFlag=e.feeFlag},methods:{switchShow:function(){this.showModel=!this.showModel},resetData:function(){var e={amount:"",singlePrice:"",useNumber:1,disabledPrice:!1,goodsTypeCloums:[{name:this.$t("please_choose_item_type")}],goodsTypeIndex:0,parentRstId:"",goodsSonTypeCloums:[{name:this.$t("please_choose_item_type")}],goodsSonTypeIndex:0,rstId:"",goodsCloums:[{resName:this.$t("please_choose_item")}],goodsIndex:0,goods:{resId:"",outLowPrice:"",outHighPrice:""},isCustom:!1,customGoodsName:"",resourceStoreInfo:[]};this.copyObject(e,this),this._loadRepairGoodsType()},copyObject:function(e,t){for(var o in t)e.hasOwnProperty(o)&&(t[o]=e[o])},_loadRepairGoodsType:function(){var e=this,t={page:1,row:100,communityId:(0,i.getCurrentCommunity)().communityId,giveType:1,parentId:"0"};(0,s.queryRepairInfo)(this,t,0==this.goodsSonTypeCloums.length).then((function(t){e.goodsTypeCloums=e.goodsTypeCloums.concat(t.data),e._appendCustomResourceStoreType()}))},_appendCustomResourceStoreType:function(){var e={rstId:"custom",name:this.$t("custom")};this.goodsTypeCloums.push(e)},_loadRepairGoods:function(){var e=this,t={resId:"",rstId:this.rstId,page:1,row:100,communityId:(0,i.getCurrentCommunity)().communityId,giveType:1,flag:1};(0,s.queryResourceStoreResName)(this,t,0==this.goodsCloums.length).then((function(t){var o=t.data;if(o.total<1)uni.showToast({icon:"none",title:e.$t("no_items")});else{var s=o.data;e.goodsCloums=[{resName:e.$t("please_choose_item")}],e.goodsIndex=0,e.goods="",e.amount="",s.length<1||(e.goodsCloums=e.goodsCloums.concat(s))}}))},goodsParentTypeChange:function(e){if(this.goodsSonTypeCloums=[{name:this.$t("please_choose_item_type")}],this.goodsSonTypeIndex=0,this.rstId="",this.goodsTypeIndex=e.target.value,0!=this.goodsTypeIndex){var t=this.goodsTypeCloums[this.goodsTypeIndex];"custom"!=t.rstId?(this.isCustom=!1,this.parentRstId=t.rstId,this._loadSonGoodsTypes()):this.isCustom=!0}else this.parentRstId=""},_loadSonGoodsTypes:function(){var e=this,t={page:1,row:100,communityId:(0,i.getCurrentCommunity)().communityId,parentId:this.parentRstId};(0,s.queryRepairInfo)(this,t,0==this.goodsSonTypeCloums.length).then((function(t){e.goodsSonTypeCloums=[{name:this.$t("please_choose_item_type")}],e.goodsSonTypeCloums=e.goodsSonTypeCloums.concat(t.data)}))},goodsTypeChange:function(e){if(this.goodsSonTypeIndex=e.target.value,0!=this.goodsSonTypeIndex){var t=this.goodsSonTypeCloums[this.goodsSonTypeIndex];this.rstId=t.rstId,this._loadRepairGoods()}else this.rstId=""},goodsChange:function(e){if(this.goodsIndex=e.target.value,0!=this.goodsIndex){var t=this.goodsCloums[this.goodsIndex];this.goods=t,t.outLowPrice==t.outHighPrice?(this.singlePrice=t.outLowPrice,this.disabledPrice=!0):(this.singlePrice="",this.disabledPrice=!1)}else this.goods=""},numDec:function(){this.useNumber<=1?uni.showToast({title:this.$t("cannot_reduce_further"),icon:"none"}):this.useNumber-=1},numInc:function(){this.useNumber+=1},_save:function(){var e="";if(this.isCustom?this.customGoodsName?"1001"!=this.feeFlag||this.singlePrice||(e=this.$t("enter_valid_amount")):e=this.$t("enter_item_name"):""==this.rstId?e=this.$t("please_choose_item_type"):this.useNumber<1?e=this.$t("item_quantity_cannot_be_zero"):this.goods?"1001"!=this.feeFlag||this.singlePrice||(e=this.$t("enter_valid_amount")):e=this.$t("please_choose_item"),""==e){var t=this.goods;t.price=this.singlePrice,t.useNumber=this.useNumber,t.isCustom=this.isCustom,t.customGoodsName=this.customGoodsName,this.isCustom&&(t.goodsTypeName=this.$t("custom")),t=JSON.stringify(t),uni.$emit("getResourceInfo",t),uni.navigateBack({delta:1})}else wx.showToast({title:e,icon:"none"})},_canel:function(){uni.navigateBack({delta:1})}}};t.default=n}}]);