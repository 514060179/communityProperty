(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-maintainance-excuteOneMaintainance"],{"0c9f":function(t,e,a){var i=a("3e16");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("4f00b2e2",i,!0,{sourceMap:!1,shadowMode:!1})},3939:function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.UpdateMaintainanceTask=function(t,e,a){return new Promise((function(i,o){t.context.post({url:n.default.UpdateMaintainanceTask,data:e,success:function(t){i(t.data)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}},a)}))},e.queryDictInfo=function(t,e,a){return new Promise((function(i,o){t.context.get({url:n.default.queryDictInfo,data:e,success:function(t){i(t.data)},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3})}},a)}))},e.queryMaintainanceItemTitle=function(t,e,a){return new Promise((function(i,o){t.context.get({url:n.default.listMaintainanceItem,data:e,success:function(t){var e=t.data;0!=e.code?o(e.msg):i(e.data)},fail:function(t){o(t)}},a)}))},e.queryMaintainanceTask=function(t,e,a){return new Promise((function(i,o){t.context.get({url:n.default.listMaintainanceTask,data:e,success:function(t){var e=t.data;if(0==e.code)return t.data.data.forEach((function(t,e){t.timeStr=t.planInsTime.replace(/:\d{1,2}$/," ")})),void i(t.data.data);o(e.msg)},fail:function(t){o(t)}},a)}))},e.queryMaintainanceTaskDetail=function(t,e,a){return new Promise((function(i,o){t.context.get({url:n.default.listMaintainanceTaskDetail,data:e,success:function(t){var e=t.data;if(0==e.code)return e.data.forEach((function(t){})),void i(e.data);o(e.msg)},fail:function(t){o(t)}},a)}))},e.updateMaintainanceTaskDetail=function(t,e,a){var i="";""==e.taskId?i="数据异常，保养任务为空":""==e.taskDetailId?i="数据异常，保养任务详情为空":""==e.machineId?i="设备不能为空":""==e.machineName?i="设备名称不能为空":""==e.patrolType?i="保养情况不能为空":""==e.description?i="保养说明不能为空":""==e.userId?i="数据异常，保养人为空":e.photos.length<=0&&(i="请上传保养图片");if(""!=i)return void wx.showToast({title:i,icon:"none",duration:2e3});return uni.showLoading({title:"请稍后..."}),new Promise((function(i,o){t.context.post({url:n.default.updateMaintainanceTaskDetail,data:e,success:function(t){i(t.data),uni.hideLoading()},fail:function(t){wx.showToast({title:i18n.t("server_error"),icon:"none",duration:2e3}),uni.hideLoading()}},a)}))},a("bf0f"),a("2797"),a("5c47"),a("a1c1"),a("01a2"),a("e39c");var n=i(a("f0de"))},"3e16":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".block__title[data-v-1764aab9]{margin:0;font-weight:400;font-size:14px;color:rgba(69,90,100,.6);padding:%?40?% %?30?% %?20?%}",""]),t.exports=e},"5b81":function(t,e,a){"use strict";a.r(e);var i=a("f82c2"),n=a("6072");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("7c47");var c=a("828b"),s=Object(c["a"])(n["default"],i["b"],i["c"],!1,null,"1764aab9",null,!1,i["a"],void 0);e["default"]=s.exports},6072:function(t,e,a){"use strict";a.r(e);var i=a("7ca4"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},"7c47":function(t,e,a){"use strict";var i=a("0c9f"),n=a.n(i);n.a},"7ca4":function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("bf0f"),a("2797"),a("aa9c"),a("01a2"),a("e39c");i(a("0c9b"));var n=a("9ef9"),o=a("3939"),c=a("2d9e"),s=(i(a("f0de")),i(a("840b"))),u=i(a("9b8e"));u.default.prototype.$preventClick=n.preventClick;var r={data:function(){return{onoff:!0,taskId:"",taskDetailId:"",machineId:"",machineName:"",pointStartTime:"",pointEndTime:"",patrolIndex:0,patrolType:"10001",patrolTypeName:"请选择",description:"",photos:[],imgList:[],communityId:"",userId:"",userName:"",titles:[],standardId:"",mapKey:"",uploadImage:{maxPhotoNum:4,imgTitle:"保养图片",canEdit:!0}}},components:{uploadImageAsync:s.default},onLoad:function(t){this.java110Context.onLoad();this.taskDetailId=t.taskDetailId,this.taskId=t.taskId,this.machineId=t.machineId,this.machineName=t.machineName,this.standardId=t.standardId,this.communityId=(0,c.getCurrentCommunity)().communityId;var e=this.java110Context.getUserInfo();this.userName=e.userName,this.userId=e.userId,this._loadMaintainanceItem()},methods:{sendImagesData:function(t){var e=this;this.photos=[],t.length>0&&t.forEach((function(t){e.photos.push(t.fileId)}))},_loadMaintainanceItem:function(){var t=this;(0,o.queryMaintainanceItemTitle)(this,{communityId:t.communityId,standardId:t.standardId,page:1,row:100},0==this.titles.length).then((function(e){e.forEach((function(t){"1001"==t.titleType?t.radio="":"2002"==t.titleType?(t.radio=[],t.titleValues.forEach((function(e){t.radio.push({checked:!1,itemValue:e.itemValue,selected:"0"})}))):t.radio=""})),t.titles=e}))},_submitExcuteMaintainance:function(){var t=this;this.description="",this.titles.forEach((function(e){var a="";"2002"==e.titleType?(e.radio.forEach((function(t){"1"==t.selected&&(a+=t.itemValue+",")})),t.description+=e.itemTitle+":"+a+";"):t.description+=e.itemTitle+":"+e.radio+";"})),(0,o.updateMaintainanceTaskDetail)(this,{taskId:this.taskId,taskDetailId:this.taskDetailId,machineId:this.machineId,machineName:this.machineName,communityId:this.communityId,description:this.description,photos:this.photos,userId:this.userId,userName:this.userName,latitude:this.latitude,longitude:this.longitude},!0).then((function(t){wx.showToast({title:t.msg,icon:"none",duration:2e3}),0!=t.code||uni.navigateBack({delta:1})}))},radioChange:function(t,e){console.log(t,e),e.radio=t.detail.value,console.log("item.radio",e.radio,t)},checkboxChange:function(t,e){e.radio.forEach((function(t){t.selected="0",t.checked=!1})),e.radio.forEach((function(e){t.detail.value.forEach((function(t){e.itemValue==t&&"0"==e.selected&&(e.selected="1",e.checked=!0)}))})),console.log("item.radio",e.radio,t)}}};e.default=r},"9ef9":function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.getFileType=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t.split("."),a=e[e.length-1];if(!a)return"";a=a.toLocaleLowerCase();var i=["png","jpg","jpeg","bmp","gif","webp"];if(i.includes(a))return"image";var n=["mp4","m4v"];if(n.includes(a))return"video";var o=["mp3","m4a","wav","aac"];if(o.includes(a))return"audio";var c=["pdf","doc","docx","xls","xlsx","ppt","pptx","txt","plain"];return c.includes(a)?"office":"unknown"},e.preventClick=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=this;a.onoff?(a.onoff=!1,t(e)):uni.showToast({title:"操作过于频繁",icon:"none"})},a("4626")},f82c2:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticClass:"block__title"},[t._v("保养"+t._s(t.machineName))]),a("v-uni-form",[t._l(t.titles,(function(e,i){return a("v-uni-view",{key:i},[a("v-uni-view",{staticClass:"block__title"},[t._v(t._s(e.itemTitle))]),"1001"==e.titleType?a("v-uni-radio-group",{staticClass:"block",on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.radioChange(a,e)}}},t._l(e.titleValues,(function(i,n){return a("v-uni-view",{key:n,staticClass:"cu-form-group"},[a("v-uni-view",{staticClass:"title"},[t._v(t._s(i.itemValue))]),a("v-uni-radio",{class:e.radio==i.itemValue?"checked":"",attrs:{checked:e.radio==i.itemValue,value:i.itemValue}})],1)})),1):"2002"==e.titleType?a("v-uni-checkbox-group",{staticClass:"block",on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.checkboxChange(a,e)}}},t._l(e.titleValues,(function(i,n){return a("v-uni-view",{key:n,staticClass:"cu-form-group "},[a("v-uni-view",{staticClass:"title"},[t._v(t._s(i.itemValue))]),a("v-uni-checkbox",{class:"1"==e.radio[n].selected?"checked":"",attrs:{checked:"1"==e.radio[n].selected,value:i.itemValue}})],1)})),1):a("v-uni-view",[a("v-uni-view",{staticClass:"cu-form-group "},[a("v-uni-textarea",{attrs:{maxlength:"512",placeholder:"请回答"},model:{value:e.radio,callback:function(a){t.$set(e,"radio",a)},expression:"item.radio"}})],1)],1)],1)})),a("uploadImageAsync",{ref:"vcUploadRef",staticStyle:{"margin-top":"30rpx"},attrs:{communityId:t.communityId,maxPhotoNum:t.uploadImage.maxPhotoNum,canEdit:t.uploadImage.canEdit,title:t.uploadImage.imgTitle},on:{sendImagesData:function(e){arguments[0]=e=t.$handleEvent(e),t.sendImagesData.apply(void 0,arguments)}}})],2),a("v-uni-view",{staticClass:"padding flex flex-direction"},[a("v-uni-button",{staticClass:"cu-btn bg-blue margin-tb-sm lg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$preventClick(t._submitExcuteMaintainance)}}},[t._v("提交")])],1)],1)},n=[]}}]);