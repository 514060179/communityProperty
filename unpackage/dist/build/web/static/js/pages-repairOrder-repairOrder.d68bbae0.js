(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-repairOrder-repairOrder"],{"2f39":function(e,t,a){"use strict";a.r(t);var r=a("c00b"),n=a.n(r);for(var i in r)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(i);t["default"]=n.a},"2faf":function(e,t,a){var r=a("f597");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var n=a("967d").default;n("195ad19b",r,!0,{sourceMap:!1,shadowMode:!1})},3121:function(e,t,a){"use strict";a("6a54");var r=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.appraiseRepair=function(e,t){return new Promise((function(a,r){if(""!=e.remark)if(""!=e.repairId){var i={repairId:e.repairId,repairType:e.repairType,repairChannel:e.repairChannel,publicArea:e.publicArea,communityId:e.communityId,context:e.remark};e.context.post({url:n.default.appraiseRepairNew,data:i,success:function(e){a(e)},fail:function(e){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},t)}else uni.showToast({title:o.default.t("wbhbxxxx"),icon:"none"});else uni.showToast({title:o.default.t("qtxpjnrs"),icon:"none"})}))},t.dispatchRepair=function(e,t){return new Promise((function(a,r){var s={staffId:e.staffId,staffName:e.staffName,context:e.content,repairId:e.repairId,repairType:e.repairType,action:e.action,communityId:(0,i.getCurrentCommunity)().communityId,photos:[],userId:e.userId,userName:e.userName},u=e.photos;u.forEach((function(e){s.photos.push({photo:e})}));var c="";""==s.context?c=o.default.t("please_enter_handling_comments"):""==s.staffId||""==s.staffName?c=o.default.t("qtxsf1"):""==s.repairId?c=o.default.t("errorData"):"TRANSFER"==s.action&&s.userId==s.staffId&&(c=o.default.t("bnzdgzj")),""==c?e.context.post({url:n.default.repairDispatch,data:s,success:function(e){a(e)},fail:function(e){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},t):wx.showToast({title:c,icon:"none",duration:2e3})}))},t.finishRepair=function(e,t){return new Promise((function(a,r){var s={feeFlag:e.feeFlag,context:e.content,repairId:e.repairId,repairChannel:e.repairChannel,publicArea:e.publicArea,maintenanceType:e.feeFlag,repairType:e.repairType,action:e.action,communityId:(0,i.getCurrentCommunity)().communityId,beforeRepairPhotos:[],afterRepairPhotos:[],repairObjType:e.repairObjType,userId:e.userId,userName:e.userName,storeId:e.storeId,choosedGoodsList:e.resourceStoreInfo,totalPrice:e.amount,payType:e.payType},u=e.beforeRepairPhotos;u.forEach((function(e){s.beforeRepairPhotos.push({photo:e})}));var c=e.afterRepairPhotos;c.forEach((function(e){s.afterRepairPhotos.push({photo:e})}));var d="";if(s.feeFlag?""==s.context?d=o.default.t("please_enter_handling_comments"):s.beforeRepairPhotos.length<=0||s.afterRepairPhotos.length<=0?d=o.default.t("qsctptt"):""==s.repairId?d=o.default.t("errorData"):("1001"==s.maintenanceType||"1003"==s.maintenanceType)&&s.choosedGoodsList.length<1?d=o.default.t("qxzwppp"):"1001"==s.maintenanceType&&""==s.payType?d=o.default.t("qxzzffssss"):("1001"==s.maintenanceType||"1003"==s.maintenanceType)&&s.choosedGoodsList.length>=1&&s.choosedGoodsList.forEach((function(e){(!e.useNumber||e.useNumber<1)&&(d=o.default.t("spslywww")),"1001"==s.maintenanceType&&(!e.price||e.price<0)&&(d=o.default.t("spjgywww"))})):d=o.default.t("qxzlxx"),""!=d)return wx.showToast({title:d,icon:"none",duration:2e3}),void(e.onoff=!0);"1002"!=s.maintenanceType&&"1004"!=s.maintenanceType||(s.useNumber=0,s.choosedGoodsList=[]),e.context.post({url:n.default.repairFinish,data:s,success:function(t){e.onoff=!0,a(t)},fail:function(t){e.onoff=!0,wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},t)}))},t.loadRepairStaff=function(e,t,a){return new Promise((function(r,i){e.context.get({url:n.default.listRepairTypeUsers,data:t,success:function(e){r(e)},fail:function(e){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},t.queryDictInfo=function(e,t,a){return new Promise((function(r,i){e.context.get({url:n.default.queryDictInfo,data:t,success:function(e){r(e.data)},fail:function(e){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},t.queryRepairInfo=function(e,t,a){return new Promise((function(r,i){e.context.get({url:n.default.queryRepairInfo,data:t,success:function(e){r(e.data)},fail:function(e){wx.showToast({title:"",icon:"none",duration:2e3})}},a)}))},t.queryResourceStoreResName=function(e,t,a){return new Promise((function(r,i){e.context.get({url:n.default.queryResourceStoreResName,data:t,success:function(e){r(e)},fail:function(e){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},t.repairStart=function(e,t,a){return new Promise((function(r,i){e.context.post({url:n.default.repairStart,data:t,success:function(e){r(e.data)},fail:function(e){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},t.repairStop=function(e,t,a){return new Promise((function(r,i){e.context.post({url:n.default.repairStop,data:t,success:function(e){r(e.data)},fail:function(e){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},t.replyRepairAppraise=function(e,t,a){return new Promise((function(r,i){t.context.post({url:n.default.replyRepairAppraise,data:e,success:function(e){r(e.data)},fail:function(e){wx.showToast({title:o.default.t("server_error"),icon:"none",duration:2e3})}},a)}))},a("bf0f"),a("2797"),a("aa9c");var n=r(a("f0de")),i=a("2d9e"),o=r(a("3e79"))},"372e":function(e,t,a){"use strict";a.r(t);var r=a("c49b"),n=a("2f39");for(var i in n)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(i);a("a748");var o=a("828b"),s=Object(o["a"])(n["default"],r["b"],r["c"],!1,null,"30abcd12",null,!1,r["a"],void 0);t["default"]=s.exports},"9ef9":function(e,t,a){"use strict";a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.getFileType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("."),a=t[t.length-1];if(!a)return"";a=a.toLocaleLowerCase();var r=["png","jpg","jpeg","bmp","gif","webp"];if(r.includes(a))return"image";var n=["mp4","m4v"];if(n.includes(a))return"video";var i=["mp3","m4a","wav","aac"];if(i.includes(a))return"audio";var o=["pdf","doc","docx","xls","xlsx","ppt","pptx","txt","plain"];return o.includes(a)?"office":"unknown"},t.preventClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=this;a.onoff?(a.onoff=!1,e(t)):uni.showToast({title:"操作过于频繁",icon:"none"})},a("4626")},a748:function(e,t,a){"use strict";var r=a("2faf"),n=a.n(r);n.a},c00b:function(e,t,a){"use strict";a("6a54");var r=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("c223"),a("bf0f"),a("2797"),a("5c47"),a("a1c1");var n=r(a("31c4")),i=r(a("bcc2")),o=a("2d9e"),s=a("3121"),u=r(a("0c9b")),c=r(a("f0de")),d=a("9ef9"),f=r(a("9b8e"));f.default.prototype.$preventClick=d.preventClick;var l={data:function(){var e=this,t=function(t){return e.$t(t)};return{onoff:!0,orderImg:u.default.baseUrl+"img/order.png",repairOrders:[],repairName:"",noData:!1,page:1,loadingStatus:"loading",loadingContentText:{contentdown:t("pull_up_to_load_more"),contentrefresh:t("loading"),contentnomore:t("no_more")},totalRecords:0}},components:{noDataPage:n.default,uniLoadMore:i.default},onLoad:function(){this.java110Context.onLoad()},onShow:function(){var e=this.java110Context.getUserInfo(),t=e.storeId;this.storeId=t,this.repairOrders=[],this.page=1,this._loadRepairOrders()},onReachBottom:function(){"noMore"!=this.loadingStatus&&this._loadRepairOrders()},methods:{loadRepairState:function(){var e=this;(0,s.queryDictInfo)(this,{name:"r_repair_pool",type:"state"},0==this.repairStates.length).then((function(t){e.repairStates=e.repairStates.concat(t)}))},repairStatesChange:function(e){if(this.repairStatesIndex=e.target.value,0!=this.repairStatesIndex){var t=this.repairStates[this.repairStatesIndex];this.repairState=t.statusCd}else this.repairState=""},checkAuth:function(e){return this.java110Context.hasPrivilege(e)},_loadRepairOrders:function(){this.loadingStatus="more";var e=this,t=this.java110Context.getUserInfo(),a=t.storeId,r={page:e.page,row:15,storeId:a,userId:t.userId,communityId:(0,o.getCurrentCommunity)().communityId,repairName:e.repairName,reqSource:"mobile"};this.java110Context.request({url:c.default.listOwnerRepairs,header:e.java110Context.getHeaders(),method:"GET",data:r,success:function(t){var a=t.data;if(0!=a.code)return e.onoff=!0,void uni.showToast({icon:"none",title:a.msg});e.totalRecords=a.total;var r=a.data;return r.forEach((function(e){var t=e.appointmentTime,a=new Date(t.replace(/-/g,"/"));e.appointmentTime=a.getMonth()+1+"-"+a.getDate()})),e.repairOrders=e.repairOrders.concat(r),e.page++,e.repairOrders.length<1?(e.onoff=!0,void(e.noData=!0)):(e.noData=!1,e.repairOrders.length==a.total?(e.onoff=!0,void(e.loadingStatus="noMore")):void 0)},fail:function(e){wx.showToast({title:that.$t("server_error"),icon:"none",duration:2e3})}},0==this.repairOrders.length)},_searchRepair:function(){this.repairOrders=[],this.page=1,this._loadRepairOrders()},_toRepairDetail:function(e){uni.navigateTo({url:"/pages/repairDetail/repairDetail?repairId="+e.repairId+"&storeId="+this.storeId})},_robOrder:function(e){uni.showLoading({title:this.$t("please_wait")+"..."});var t=this,a=this.java110Context.getUserInfo(),r={communityId:(0,o.getCurrentCommunity)().communityId,repairId:e.repairId,userName:a.userName};this.java110Context.request({url:c.default.robRepairOrder,header:t.java110Context.getHeaders(),method:"POST",data:r,success:function(e){uni.hideLoading(),wx.showToast({title:e.data.msg,duration:2e3,icon:"none"}),setTimeout((function(){t.repairOrders=[],t.page=1,t._loadRepairOrders()}),1500)},fail:function(e){uni.hideLoading(),wx.showToast({title:that.$t("server_error"),icon:"none",duration:2e3})}},0==this.repairOrders.length)},dealRepair:function(e,t){uni.navigateTo({url:"/pages/repairHandle/repairHandle?action="+t+"&repairId="+e.repairId+"&repairType="+e.repairType+"&preStaffId="+e.preStaffId+"&preStaffName="+e.preStaffName+"&repairObjType="+e.repairObjType})}}};t.default=l},c49b:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r}));var r={uniLoadMore:a("bcc2").default,noDataPage:a("31c4").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("v-uni-view",{staticClass:"cu-bar bg-white search "},[a("v-uni-view",{staticClass:"search-form round"},[a("v-uni-text",{staticClass:"cuIcon-search"}),a("v-uni-input",{attrs:{type:"text",placeholder:e.$t("input_repairer"),"confirm-type":"search"},model:{value:e.repairName,callback:function(t){e.repairName=t},expression:"repairName"}})],1),a("v-uni-view",{staticClass:"action"},[a("v-uni-button",{staticClass:"cu-btn bg-gradual-blue shadow-blur round",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$preventClick(e._searchRepair)}}},[e._v("搜索")])],1)],1),0==e.noData?a("v-uni-view",{staticClass:"margin-top"},[a("v-uni-view",{staticClass:"text-df text-gray text-right"},[e._v(e._s(e.$t("gong"))+e._s(e.totalRecords)+e._s(e.$t("records")))]),e._l(e.repairOrders,(function(t,r){return a("v-uni-view",{key:r,staticClass:"cu-list menu-avatar ",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e._toRepairDetail(t)}}},[a("v-uni-view",{staticClass:"cu-item arrow"},[a("v-uni-view",{staticClass:"content content-left"},[a("v-uni-view",{staticClass:"text-grey"},[a("v-uni-text",{staticClass:"cuIcon-notification text-cut text-blue margin-right-xs"}),a("v-uni-text",{staticClass:"ellip"},[e._v(e._s(t.repairObjName)+"-"+e._s(t.stateName)+"("+e._s(t.repairSettingTypeName)+")")])],1),a("v-uni-view",{staticClass:"text-gray text-sm flex"},[a("v-uni-view",{staticClass:"text-cut"},[e._v(e._s(e.$t("repairer"))+"："+e._s(t.repairName)+"-"+e._s(t.tel))])],1)],1),1e3==t.state&&e.checkAuth("502019101946430010")?a("v-uni-view",{staticClass:"rob-order text-df text-white bg-blue text-center",on:{click:function(a){a.stopPropagation(),arguments[0]=a=e.$handleEvent(a),e.dealRepair(t,"DISPATCH")}}},[e._v(e._s(e.$t("dispatch")))]):e._e(),100==t.repairWay&&1e3==t.state&&e.checkAuth("502021012099350016")?a("v-uni-view",{staticClass:"rob-order text-df text-white bg-blue text-center",on:{click:function(a){a.stopPropagation(),arguments[0]=a=e.$handleEvent(a),e._robOrder(t)}}},[e._v("抢单")]):a("v-uni-view",{staticClass:"action"},[a("v-uni-view",{staticClass:"text-grey text-xs"},[e._v(e._s(t.appointmentTime)),a("v-uni-text",{staticClass:"lg text-gray cuIcon-right margin-left-xs"})],1)],1)],1)],1)})),a("uni-load-more",{attrs:{status:e.loadingStatus,"content-text":e.loadingContentText}})],2):a("v-uni-view",[a("no-data-page")],1)],1)},i=[]},f597:function(e,t,a){var r=a("c86c");t=r(!1),t.push([e.i,".cu-list.menu-avatar>.cu-item .content-left[data-v-30abcd12]{left:%?30?%}.cu-list+.cu-list[data-v-30abcd12]{margin-top:%?20?%}\n\n/* 抢单按钮 */.rob-order[data-v-30abcd12]{width:%?80?%;height:%?80?%;line-height:%?80?%;border-radius:50%}.record-add[data-v-30abcd12]{position:fixed;right:%?10?%;bottom:%?50?%;width:%?100?%;height:%?100?%}.record-add img[data-v-30abcd12]{width:100%;height:100%}.ellip[data-v-30abcd12]{overflow:hidden;text-overflow:ellipsis;white-space:normal;word-break:break-all;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;align-content:center;width:%?400?%}",""]),e.exports=t}}]);